{"cells":[{"cell_type":"markdown","metadata":{"id":"kHPXsfgDTrzD"},"source":["# 라이브러리"]},{"cell_type":"code","execution_count":1,"metadata":{"executionInfo":{"elapsed":1808,"status":"ok","timestamp":1648304324529,"user":{"displayName":"DSL pro","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"14206082489801303909"},"user_tz":-540},"id":"ehv0V0rZ2LlG"},"outputs":[],"source":["import pandas as pd\n","import numpy as np\n","import os\n","import glob\n","from datetime import datetime\n","import xml.etree.ElementTree as ET \n","import cv2\n","import matplotlib.pyplot as plt\n","import seaborn as sns\n","import warnings\n","warnings.filterwarnings('ignore')"]},{"cell_type":"markdown","metadata":{"id":"A_nB0KWhXLQF"},"source":["yolov5 학습 시 필요한 모듈 설치"]},{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":989,"status":"ok","timestamp":1648304325509,"user":{"displayName":"DSL pro","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"14206082489801303909"},"user_tz":-540},"id":"zxGWl5i22PMW","outputId":"61a61662-1a45-4220-8171-5853a1962d4d"},"outputs":[{"name":"stdout","output_type":"stream","text":["\u001b[31mERROR: Could not open requirements file: [Errno 2] No such file or directory: 'yolov5/requirements.txt'\u001b[0m\n"]}],"source":["!pip install -qr yolov5/requirements.txt"]},{"cell_type":"markdown","metadata":{"id":"CvYQYjAjwG7e"},"source":["# Data "]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2752,"status":"ok","timestamp":1648003030138,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"7khKTWz21MMe"},"outputs":[{"name":"stdout","output_type":"stream","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"markdown","metadata":{"id":"tcn68FSy19j3"},"source":["CNNproject 폴더로 경로 설정"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5,"status":"ok","timestamp":1648003030138,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"ZgJRYGrd10cv","outputId":"49e888b3-e4e5-4970-88b3-d2f22bdca88a"},"outputs":[{"name":"stdout","output_type":"stream","text":["/content/drive/MyDrive/CNNproject\n"]}],"source":["%cd /content/drive/MyDrive/CNNproject"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":520,"status":"ok","timestamp":1647956047343,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"BlaTFexdX82J","outputId":"50906bc9-1006-4867-e482-ace7ab8d75c3"},"outputs":[{"name":"stdout","output_type":"stream","text":["김원\t진유리\t안민용\t절대건들면안되는죽음의코드  BBfinal\t   image\n","최연수\t전혜령\t김경한\t1.xml\t\t\t    BBfinal.ipynb  yolov5\n"]}],"source":["!ls"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"IeWa2sn42xy_"},"outputs":[],"source":["# 이미지 폴더 주소\n","image_folder = './image/train_img_' # 원본 trian 데이터\n","# XML파일 폴더 주소\n","path_an = \"./image/face_mask_detection/annotations\" "]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":10016,"status":"ok","timestamp":1647959107711,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"R18R9ES1XTI-","outputId":"4e20b81c-7445-4eac-83af-4ddea2133521"},"outputs":[{"data":{"text/plain":["597"]},"execution_count":10,"metadata":{},"output_type":"execute_result"}],"source":["# 원본 train 데이터 수\n","len(os.listdir(image_folder))"]},{"cell_type":"markdown","metadata":{"id":"h4jY2PcrwJlz"},"source":["## data df"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"H9cP2CQK1Kwm"},"outputs":[],"source":["dataset = {\n","            \"file\":[],\n","            \"name\":[],    \n","            \"width\":[],\n","            \"height\":[],\n","            \"xmin\":[],\n","            \"ymin\":[],   \n","            \"xmax\":[],\n","            \"ymax\":[],\n","           }"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ZwuQQayj21Js"},"outputs":[],"source":["# xml to dataframe\n","for anno in glob.glob(path_an+\"/*.xml\"):\n","    tree = ET.parse(anno)\n","    \n","    for elem in tree.iter():\n","        if 'filename' in elem.tag:\n","            #print(filename)\n","            filename = elem.text\n","        if 'size' in elem.tag:\n","            for attr in list(elem):\n","                if 'width' in attr.tag: \n","                    width = int(round(float(attr.text)))\n","                if 'height' in attr.tag:\n","                    height = int(round(float(attr.text)))    \n","\n","        if 'object' in elem.tag:\n","            for attr in list(elem):\n","                \n","                if 'name' in attr.tag:\n","                    name = attr.text                 \n","                    dataset['name']+=[name]\n","                    dataset['width']+=[width]\n","                    dataset['height']+=[height] \n","                    #dataset['file']+=[anno.split('/')[-1][0:-4]] \n","                    #print(filename)\n","                    dataset['file'].append(filename[0:-4])\n","                            \n","                if 'bndbox' in attr.tag:\n","                    for dim in list(attr):\n","                        if 'xmin' in dim.tag:\n","                            xmin = int(round(float(dim.text)))\n","                            dataset['xmin']+=[xmin]\n","                        if 'ymin' in dim.tag:\n","                            ymin = int(round(float(dim.text)))\n","                            dataset['ymin']+=[ymin]                                \n","                        if 'xmax' in dim.tag:\n","                            xmax = int(round(float(dim.text)))\n","                            dataset['xmax']+=[xmax]                                \n","                        if 'ymax' in dim.tag:\n","                            ymax = int(round(float(dim.text)))\n","                            dataset['ymax']+=[ymax]"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":250},"executionInfo":{"elapsed":20,"status":"ok","timestamp":1647959130006,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"8V4eAb1928Va","outputId":"2bbc845e-e0de-42e7-ea0c-d3971651e3b3"},"outputs":[{"data":{"text/html":["\n","  \u003cdiv id=\"df-b11c0c9b-abf4-4ba6-88b7-c5316587e9b8\"\u003e\n","    \u003cdiv class=\"colab-df-container\"\u003e\n","      \u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003efile\u003c/th\u003e\n","      \u003cth\u003ename\u003c/th\u003e\n","      \u003cth\u003ewidth\u003c/th\u003e\n","      \u003cth\u003eheight\u003c/th\u003e\n","      \u003cth\u003exmin\u003c/th\u003e\n","      \u003cth\u003eymin\u003c/th\u003e\n","      \u003cth\u003exmax\u003c/th\u003e\n","      \u003cth\u003eymax\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss0\u003c/td\u003e\n","      \u003ctd\u003ewithout_mask\u003c/td\u003e\n","      \u003ctd\u003e512\u003c/td\u003e\n","      \u003ctd\u003e366\u003c/td\u003e\n","      \u003ctd\u003e79\u003c/td\u003e\n","      \u003ctd\u003e105\u003c/td\u003e\n","      \u003ctd\u003e109\u003c/td\u003e\n","      \u003ctd\u003e142\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss0\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e512\u003c/td\u003e\n","      \u003ctd\u003e366\u003c/td\u003e\n","      \u003ctd\u003e185\u003c/td\u003e\n","      \u003ctd\u003e100\u003c/td\u003e\n","      \u003ctd\u003e226\u003c/td\u003e\n","      \u003ctd\u003e144\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss0\u003c/td\u003e\n","      \u003ctd\u003ewithout_mask\u003c/td\u003e\n","      \u003ctd\u003e512\u003c/td\u003e\n","      \u003ctd\u003e366\u003c/td\u003e\n","      \u003ctd\u003e325\u003c/td\u003e\n","      \u003ctd\u003e90\u003c/td\u003e\n","      \u003ctd\u003e360\u003c/td\u003e\n","      \u003ctd\u003e141\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e3\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss106\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e600\u003c/td\u003e\n","      \u003ctd\u003e399\u003c/td\u003e\n","      \u003ctd\u003e154\u003c/td\u003e\n","      \u003ctd\u003e51\u003c/td\u003e\n","      \u003ctd\u003e423\u003c/td\u003e\n","      \u003ctd\u003e391\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss11\u003c/td\u003e\n","      \u003ctd\u003emask_weared_incorrect\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e267\u003c/td\u003e\n","      \u003ctd\u003e23\u003c/td\u003e\n","      \u003ctd\u003e114\u003c/td\u003e\n","      \u003ctd\u003e77\u003c/td\u003e\n","      \u003ctd\u003e172\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e\n","      \u003cbutton class=\"colab-df-convert\" onclick=\"convertToInteractive('df-b11c0c9b-abf4-4ba6-88b7-c5316587e9b8')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\"\u003e\n","        \n","  \u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\"\u003e\n","    \u003cpath d=\"M0 0h24v24H0V0z\" fill=\"none\"/\u003e\n","    \u003cpath d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/\u003e\u003cpath d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/\u003e\n","  \u003c/svg\u003e\n","      \u003c/button\u003e\n","      \n","  \u003cstyle\u003e\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  \u003c/style\u003e\n","\n","      \u003cscript\u003e\n","        const buttonEl =\n","          document.querySelector('#df-b11c0c9b-abf4-4ba6-88b7-c5316587e9b8 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-b11c0c9b-abf4-4ba6-88b7-c5316587e9b8');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '\u003ca target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb\u003edata table notebook\u003c/a\u003e'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      \u003c/script\u003e\n","    \u003c/div\u003e\n","  \u003c/div\u003e\n","  "],"text/plain":["              file                   name  width  height  xmin  ymin  xmax  \\\n","0    maksssksksss0           without_mask    512     366    79   105   109   \n","1    maksssksksss0              with_mask    512     366   185   100   226   \n","2    maksssksksss0           without_mask    512     366   325    90   360   \n","3  maksssksksss106              with_mask    600     399   154    51   423   \n","4   maksssksksss11  mask_weared_incorrect    400     267    23   114    77   \n","\n","   ymax  \n","0   142  \n","1   144  \n","2   141  \n","3   391  \n","4   172  "]},"execution_count":13,"metadata":{},"output_type":"execute_result"}],"source":["# 한 이미지에 여러 개의 박스가 쳐져 있는 경우가 존재한다\n","df=pd.DataFrame(dataset)\n","df.head()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":8,"status":"ok","timestamp":1647959130006,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"eSvBxL9ps-n6","outputId":"c483a14e-ad20-4f8c-f7cf-30c40d91f436"},"outputs":[{"data":{"text/plain":["853"]},"execution_count":14,"metadata":{},"output_type":"execute_result"}],"source":["len(df['file'].unique())"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"FwNGrbf2hYMk"},"outputs":[],"source":["# train file에 해당하는 annotation file만 남기기\n","train_file = [*os.listdir(image_folder)]\n","train_filename = []\n","for filename in train_file:\n","  filename = filename[:-4]\n","  train_filename.append(filename)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2sreF5dgheFp"},"outputs":[],"source":["df = df[df['file'].isin(train_filename)]"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7,"status":"ok","timestamp":1647959130007,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"9rhrhB8wtE1O","outputId":"fb4fdad3-3a34-4f8e-bfac-79e0890c6f9b"},"outputs":[{"data":{"text/plain":["597"]},"execution_count":17,"metadata":{},"output_type":"execute_result"}],"source":["len(df['file'].unique())"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"elapsed":6,"status":"ok","timestamp":1647959130007,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"1oYFqeUwiyKf","outputId":"33537de2-52f0-49e2-c22c-a8cd3bc2cdcb"},"outputs":[{"data":{"text/html":["\n","  \u003cdiv id=\"df-71a81035-0e8f-4b5f-9d29-fc07bf1ff73e\"\u003e\n","    \u003cdiv class=\"colab-df-container\"\u003e\n","      \u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003efile\u003c/th\u003e\n","      \u003cth\u003ename\u003c/th\u003e\n","      \u003cth\u003ewidth\u003c/th\u003e\n","      \u003cth\u003eheight\u003c/th\u003e\n","      \u003cth\u003exmin\u003c/th\u003e\n","      \u003cth\u003eymin\u003c/th\u003e\n","      \u003cth\u003exmax\u003c/th\u003e\n","      \u003cth\u003eymax\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss0\u003c/td\u003e\n","      \u003ctd\u003ewithout_mask\u003c/td\u003e\n","      \u003ctd\u003e512\u003c/td\u003e\n","      \u003ctd\u003e366\u003c/td\u003e\n","      \u003ctd\u003e79\u003c/td\u003e\n","      \u003ctd\u003e105\u003c/td\u003e\n","      \u003ctd\u003e109\u003c/td\u003e\n","      \u003ctd\u003e142\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss0\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e512\u003c/td\u003e\n","      \u003ctd\u003e366\u003c/td\u003e\n","      \u003ctd\u003e185\u003c/td\u003e\n","      \u003ctd\u003e100\u003c/td\u003e\n","      \u003ctd\u003e226\u003c/td\u003e\n","      \u003ctd\u003e144\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss0\u003c/td\u003e\n","      \u003ctd\u003ewithout_mask\u003c/td\u003e\n","      \u003ctd\u003e512\u003c/td\u003e\n","      \u003ctd\u003e366\u003c/td\u003e\n","      \u003ctd\u003e325\u003c/td\u003e\n","      \u003ctd\u003e90\u003c/td\u003e\n","      \u003ctd\u003e360\u003c/td\u003e\n","      \u003ctd\u003e141\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e21\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss1\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e156\u003c/td\u003e\n","      \u003ctd\u003e321\u003c/td\u003e\n","      \u003ctd\u003e34\u003c/td\u003e\n","      \u003ctd\u003e354\u003c/td\u003e\n","      \u003ctd\u003e69\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e22\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss1\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e156\u003c/td\u003e\n","      \u003ctd\u003e224\u003c/td\u003e\n","      \u003ctd\u003e38\u003c/td\u003e\n","      \u003ctd\u003e261\u003c/td\u003e\n","      \u003ctd\u003e73\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e\n","      \u003cbutton class=\"colab-df-convert\" onclick=\"convertToInteractive('df-71a81035-0e8f-4b5f-9d29-fc07bf1ff73e')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\"\u003e\n","        \n","  \u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\"\u003e\n","    \u003cpath d=\"M0 0h24v24H0V0z\" fill=\"none\"/\u003e\n","    \u003cpath d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/\u003e\u003cpath d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/\u003e\n","  \u003c/svg\u003e\n","      \u003c/button\u003e\n","      \n","  \u003cstyle\u003e\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  \u003c/style\u003e\n","\n","      \u003cscript\u003e\n","        const buttonEl =\n","          document.querySelector('#df-71a81035-0e8f-4b5f-9d29-fc07bf1ff73e button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-71a81035-0e8f-4b5f-9d29-fc07bf1ff73e');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '\u003ca target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb\u003edata table notebook\u003c/a\u003e'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      \u003c/script\u003e\n","    \u003c/div\u003e\n","  \u003c/div\u003e\n","  "],"text/plain":["             file          name  width  height  xmin  ymin  xmax  ymax\n","0   maksssksksss0  without_mask    512     366    79   105   109   142\n","1   maksssksksss0     with_mask    512     366   185   100   226   144\n","2   maksssksksss0  without_mask    512     366   325    90   360   141\n","21  maksssksksss1     with_mask    400     156   321    34   354    69\n","22  maksssksksss1     with_mask    400     156   224    38   261    73"]},"execution_count":18,"metadata":{},"output_type":"execute_result"}],"source":["df.head()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7,"status":"ok","timestamp":1647959130008,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"kBEk0cYFYWRX","outputId":"54c0ee3c-f3b2-4848-d13b-3a60ef60e5e9"},"outputs":[{"data":{"text/plain":["array(['without_mask', 'with_mask', 'mask_weared_incorrect'], dtype=object)"]},"execution_count":19,"metadata":{},"output_type":"execute_result"}],"source":["df['name'].unique()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RM5LUfTL3AeS"},"outputs":[],"source":["def name_change(x):\n","    # name이 face인 경우\n","    if (x == 'face'):\n","        return 'without_mask'\n","    else :\n","        return x"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"MOTD0So43CTT"},"outputs":[],"source":["df['name'] = df['name'].apply(lambda x : name_change(x))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"efu8VNNS3EOb"},"outputs":[],"source":["# class 생성\n","name_dict = {\n","    'with_mask': 0,\n","    'mask_weared_incorrect': 1,\n","    'without_mask': 2 \n","}"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"aRsjzSMX3F2r"},"outputs":[],"source":["df['class'] = df['name'].map(name_dict)"]},{"cell_type":"markdown","metadata":{"id":"Nu68qRbSwfyu"},"source":["## resize"]},{"cell_type":"markdown","metadata":{"id":"P25zVqo2a3uy"},"source":["이미지 resize\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":36},"executionInfo":{"elapsed":528,"status":"ok","timestamp":1647959136780,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"WaU7uIwmul7E","outputId":"24d938c0-d673-4a65-c9fd-40dd612574cd"},"outputs":[{"data":{"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"},"text/plain":["'./image/train_img_'"]},"execution_count":22,"metadata":{},"output_type":"execute_result"}],"source":["image_folder"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"e1rAh42u3qcf"},"outputs":[],"source":["from PIL import Image\n","\n","def copyImages(imageList):\n","    for image in imageList:\n","        img = Image.open(image_folder+\"/\"+image)\n","        img1 = img.resize((640, 480)) # 원본 이미지 사이즈 통일 (640 * 480)\n","        _ = img1.save(\"./image/train_images/\"+image)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"HtUXzD5V39yr"},"outputs":[],"source":["#copyImages(train_file)"]},{"cell_type":"markdown","metadata":{"id":"6kFqhe_sa5dv"},"source":["bb resize"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"yNyhgX8N4ASi"},"outputs":[],"source":["df['xmax'] = (640/df['width'])*df['xmax']\n","df['ymax'] = (480/df['height'])*df['ymax']\n","df['xmin'] = (640/df['width'])*df['xmin']\n","df['ymin'] = (480/df['height'])*df['ymin']"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"X0k4eP5j4Bi_"},"outputs":[],"source":["df[['xmax', 'ymax', 'xmin', 'ymin']] = df[['xmax', 'ymax', 'xmin', 'ymin']].astype('int64')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"MubU275a4DDy"},"outputs":[],"source":["df['x_center'] = (df['xmax']+df['xmin'])/(2*640)\n","df['y_center'] = (df['ymax']+df['ymin'])/(2*480)\n","df['box_height'] = (df['xmax']-df['xmin'])/(640)\n","df['box_width'] = (df['ymax']-df['ymin'])/(480)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":270},"executionInfo":{"elapsed":3,"status":"ok","timestamp":1647959146219,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"P67OYsjCVTU_","outputId":"345da3e6-ea11-4275-8774-e162fc933a5f"},"outputs":[{"data":{"text/html":["\n","  \u003cdiv id=\"df-6abf9f55-2ad1-411f-a78b-ebcfa0ac6bef\"\u003e\n","    \u003cdiv class=\"colab-df-container\"\u003e\n","      \u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003efile\u003c/th\u003e\n","      \u003cth\u003ename\u003c/th\u003e\n","      \u003cth\u003ewidth\u003c/th\u003e\n","      \u003cth\u003eheight\u003c/th\u003e\n","      \u003cth\u003exmin\u003c/th\u003e\n","      \u003cth\u003eymin\u003c/th\u003e\n","      \u003cth\u003exmax\u003c/th\u003e\n","      \u003cth\u003eymax\u003c/th\u003e\n","      \u003cth\u003eclass\u003c/th\u003e\n","      \u003cth\u003ex_center\u003c/th\u003e\n","      \u003cth\u003ey_center\u003c/th\u003e\n","      \u003cth\u003ebox_height\u003c/th\u003e\n","      \u003cth\u003ebox_width\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss0\u003c/td\u003e\n","      \u003ctd\u003ewithout_mask\u003c/td\u003e\n","      \u003ctd\u003e512\u003c/td\u003e\n","      \u003ctd\u003e366\u003c/td\u003e\n","      \u003ctd\u003e98\u003c/td\u003e\n","      \u003ctd\u003e137\u003c/td\u003e\n","      \u003ctd\u003e136\u003c/td\u003e\n","      \u003ctd\u003e186\u003c/td\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e0.182812\u003c/td\u003e\n","      \u003ctd\u003e0.336458\u003c/td\u003e\n","      \u003ctd\u003e0.059375\u003c/td\u003e\n","      \u003ctd\u003e0.102083\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss0\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e512\u003c/td\u003e\n","      \u003ctd\u003e366\u003c/td\u003e\n","      \u003ctd\u003e231\u003c/td\u003e\n","      \u003ctd\u003e131\u003c/td\u003e\n","      \u003ctd\u003e282\u003c/td\u003e\n","      \u003ctd\u003e188\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0.400781\u003c/td\u003e\n","      \u003ctd\u003e0.332292\u003c/td\u003e\n","      \u003ctd\u003e0.079687\u003c/td\u003e\n","      \u003ctd\u003e0.118750\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss0\u003c/td\u003e\n","      \u003ctd\u003ewithout_mask\u003c/td\u003e\n","      \u003ctd\u003e512\u003c/td\u003e\n","      \u003ctd\u003e366\u003c/td\u003e\n","      \u003ctd\u003e406\u003c/td\u003e\n","      \u003ctd\u003e118\u003c/td\u003e\n","      \u003ctd\u003e450\u003c/td\u003e\n","      \u003ctd\u003e184\u003c/td\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e0.668750\u003c/td\u003e\n","      \u003ctd\u003e0.314583\u003c/td\u003e\n","      \u003ctd\u003e0.068750\u003c/td\u003e\n","      \u003ctd\u003e0.137500\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e21\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss1\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e156\u003c/td\u003e\n","      \u003ctd\u003e513\u003c/td\u003e\n","      \u003ctd\u003e104\u003c/td\u003e\n","      \u003ctd\u003e566\u003c/td\u003e\n","      \u003ctd\u003e212\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0.842969\u003c/td\u003e\n","      \u003ctd\u003e0.329167\u003c/td\u003e\n","      \u003ctd\u003e0.082812\u003c/td\u003e\n","      \u003ctd\u003e0.225000\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e22\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss1\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e156\u003c/td\u003e\n","      \u003ctd\u003e358\u003c/td\u003e\n","      \u003ctd\u003e116\u003c/td\u003e\n","      \u003ctd\u003e417\u003c/td\u003e\n","      \u003ctd\u003e224\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0.605469\u003c/td\u003e\n","      \u003ctd\u003e0.354167\u003c/td\u003e\n","      \u003ctd\u003e0.092188\u003c/td\u003e\n","      \u003ctd\u003e0.225000\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e\n","      \u003cbutton class=\"colab-df-convert\" onclick=\"convertToInteractive('df-6abf9f55-2ad1-411f-a78b-ebcfa0ac6bef')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\"\u003e\n","        \n","  \u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\"\u003e\n","    \u003cpath d=\"M0 0h24v24H0V0z\" fill=\"none\"/\u003e\n","    \u003cpath d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/\u003e\u003cpath d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/\u003e\n","  \u003c/svg\u003e\n","      \u003c/button\u003e\n","      \n","  \u003cstyle\u003e\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  \u003c/style\u003e\n","\n","      \u003cscript\u003e\n","        const buttonEl =\n","          document.querySelector('#df-6abf9f55-2ad1-411f-a78b-ebcfa0ac6bef button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-6abf9f55-2ad1-411f-a78b-ebcfa0ac6bef');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '\u003ca target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb\u003edata table notebook\u003c/a\u003e'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      \u003c/script\u003e\n","    \u003c/div\u003e\n","  \u003c/div\u003e\n","  "],"text/plain":["             file          name  width  height  xmin  ymin  xmax  ymax  class  \\\n","0   maksssksksss0  without_mask    512     366    98   137   136   186      2   \n","1   maksssksksss0     with_mask    512     366   231   131   282   188      0   \n","2   maksssksksss0  without_mask    512     366   406   118   450   184      2   \n","21  maksssksksss1     with_mask    400     156   513   104   566   212      0   \n","22  maksssksksss1     with_mask    400     156   358   116   417   224      0   \n","\n","    x_center  y_center  box_height  box_width  \n","0   0.182812  0.336458    0.059375   0.102083  \n","1   0.400781  0.332292    0.079687   0.118750  \n","2   0.668750  0.314583    0.068750   0.137500  \n","21  0.842969  0.329167    0.082812   0.225000  \n","22  0.605469  0.354167    0.092188   0.225000  "]},"execution_count":26,"metadata":{},"output_type":"execute_result"}],"source":["df.head() # 아래 df에서 width, height를 제외한 값은 모두 (640 * 480) 기준으로 조정된 값입니다"]},{"cell_type":"markdown","metadata":{"id":"zubSTeqwNCKq"},"source":["## annotation xml 저장"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tGYxd5WiVvhA"},"outputs":[],"source":["file_name = list(df.file.unique())"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"egSs2-8aWxhi"},"outputs":[],"source":["from xml.etree.ElementTree import Element, SubElement, ElementTree"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"EvLl-RubWqDF"},"outputs":[],"source":["def writeXML(df, filename, tag):\n","    root = Element('annotation')\n","    SubElement(root, 'folder').text = 'images'\n","    SubElement(root, 'filename').text = filename + tag\n","    SubElement(root, 'path').text = '/content/drive/MyDrive/CNNproject/image/train_images/' + filename + tag\n","    source = SubElement(root, 'source')\n","    SubElement(source, 'database').text = 'Unknown'\n","\n","    size = SubElement(root, 'size')\n","    SubElement(size, 'width').text = '640'\n","    SubElement(size, 'height').text = '480'\n","    SubElement(size, 'depth').text = '3'\n","    \n","    SubElement(root, 'segmented').text = '0'\n","\n","    # print(1)\n","    for index, row in df.iterrows():\n","        obj = SubElement(root, 'object')\n","        SubElement(obj, 'name').text = str(row['name'])\n","        SubElement(obj, 'pose').text = 'Unspecified'\n","        SubElement(obj, 'truncated').text = '0'\n","        SubElement(obj, 'occluded').text = '0'\n","        SubElement(obj, 'difficult').text = '0'\n","        bndbox = SubElement(obj, 'bndbox')\n","        SubElement(bndbox, 'xmin').text = str(row['xmin']) \n","        SubElement(bndbox, 'ymin').text = str(row['ymin'])\n","        SubElement(bndbox, 'xmax').text = str(row['xmax'])\n","        SubElement(bndbox, 'ymax').text = str(row['ymax'])\n","        # print(obj.tag)\n","        \n","    tree = ElementTree(root)\n","    # print(root.text)\n","    tree.write(\"/content/drive/MyDrive/CNNproject/image/train_annotations/\" + filename + \".xml\", encoding = 'utf-8', xml_declaration=True)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mh1FuWBFWOeM"},"outputs":[],"source":["for i in file_name:\n","    temp = df[df['file'] == i]\n","    writeXML(temp, i, '.png')"]},{"cell_type":"markdown","metadata":{"id":"WpKh1yjlwhJR"},"source":["## augmentation"]},{"cell_type":"markdown","metadata":{"id":"R2pW79C1x73C"},"source":["### 흑백처리"]},{"cell_type":"markdown","metadata":{"id":"Lp0-hj3B8J9m"},"source":["** 흑백처리 코드는 이미 처리 완료돼서 안돌려도 됩니다!"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"UdytAz3im6ga"},"outputs":[],"source":["import cv2\n","from google.colab.patches import cv2_imshow\n","from os import listdir\n","from random import *\n","from PIL import Image\n","import numpy as np"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":398,"status":"ok","timestamp":1647959175651,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"PyU-eDc6lx9E","outputId":"3e3e4c57-ac49-48ac-ebea-209b56ded3bd"},"outputs":[{"name":"stdout","output_type":"stream","text":["/content/drive/MyDrive/CNNproject\n"]}],"source":["%cd ."]},{"cell_type":"code","execution_count":null,"metadata":{"id":"E7TKmDsJm6pp"},"outputs":[],"source":["path = './image/train_images/'\n","newpath = './image/train_images/'"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"e4nzxikNm6yU"},"outputs":[],"source":["for file in listdir(path):\n","  img = Image.open(path + file).convert('L')\n","  img_numpy = np.array(img,'uint8')\n","  cv2.imwrite(newpath + \"gray_\" + file, img_numpy)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":274,"status":"ok","timestamp":1647959258254,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"krRjUgS0m5sm","outputId":"930f41ea-6f94-4b71-9e03-d46b1d66ca00"},"outputs":[{"name":"stdout","output_type":"stream","text":["원본 + 흑백처리 이미지 수:  1194\n"]}],"source":["print(\"원본 + 흑백처리 이미지 수: \", len(os.listdir(newpath))) "]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":36},"executionInfo":{"elapsed":7339,"status":"ok","timestamp":1647956367443,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"5ovqKJbpnnqC","outputId":"95332b10-564c-4c13-bebe-fb76518b1749"},"outputs":[{"data":{"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"},"text/plain":["'/content/drive/MyDrive/CNNproject/image/train_annotations2'"]},"execution_count":42,"metadata":{},"output_type":"execute_result"}],"source":["import shutil\n","\n","shutil.copytree(\"/content/drive/MyDrive/CNNproject/image/train_annotations\",\n","                \"/content/drive/MyDrive/CNNproject/image/train_annotations2\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"GFJ1uJZSn2CK"},"outputs":[],"source":["file_path = '/content/drive/MyDrive/CNNproject/image/train_annotations2'\n","file_names = os.listdir(file_path)\n","\n","for name in file_names:\n","    src = os.path.join(file_path, name)\n","    dst = 'gray_' + name\n","    dst = os.path.join(file_path, dst)\n","    os.rename(src, dst)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"taIpvcdDoOtz"},"outputs":[],"source":["source_dir = '/content/drive/MyDrive/CNNproject/image/train_annotations2'\n","target_dir = '/content/drive/MyDrive/CNNproject/image/train_annotations'\n","    \n","file_names = list(glob.glob('/content/drive/MyDrive/CNNproject/image/train_annotations2/*.xml'))\n","    \n","for file_name in file_names:\n","    shutil.move(os.path.join(source_dir, file_name), target_dir)\n","\n","os.rmdir(source_dir)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":3,"status":"ok","timestamp":1647959280886,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"WY656p1D96Hs","outputId":"0653f857-1c66-49f2-f953-12b448de06f7"},"outputs":[{"name":"stdout","output_type":"stream","text":["원본 + 흑백처리 annotation 수:  1194\n"]}],"source":["print(\"원본 + 흑백처리 annotation 수: \",len(os.listdir(\"./image/train_annotations\")))"]},{"cell_type":"markdown","metadata":{"id":"dms5aHm5yAM7"},"source":["### flip, rotate"]},{"cell_type":"markdown","metadata":{"id":"OdnONCoa8IIh"},"source":["flip, rotate시킨 image, annotation 모두 img_, annot_ 폴더에 저장해두었습니다."]},{"cell_type":"code","execution_count":null,"metadata":{"id":"f8DxlfWAL-uV"},"outputs":[],"source":["!pip install \"opencv-python-headless\u003c4.3\""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"sDSa2iSEL5RC"},"outputs":[],"source":["!pip install --upgrade albumentations"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":295,"status":"ok","timestamp":1647959330458,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"FHtDQJwvKljo","outputId":"28b0c289-a2ae-4d51-b0f1-882a8f0047e8"},"outputs":[{"name":"stdout","output_type":"stream","text":["/content/drive/MyDrive/CNNproject\n","/content/drive/MyDrive/CNNproject/image\n"]}],"source":["import os\n","current_path = os.getcwd()\n","print(current_path)\n","os.chdir('/content/drive/MyDrive/CNNproject/image/')\n","print(os.getcwd())"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":392,"status":"ok","timestamp":1647959332564,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"BgTX_HPyVf7j","outputId":"4fb1ead7-dc7f-4d49-a72a-7254325a5ede"},"outputs":[{"name":"stdout","output_type":"stream","text":["1194\n"]}],"source":["path = 'train_images'\n","file_list = os.listdir(path) \n","print (len(file_list))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2,"status":"ok","timestamp":1647959333769,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"Ny3xcEceWxsa","outputId":"99d4e938-54a4-41ac-f82e-4eb48663f23c"},"outputs":[{"name":"stdout","output_type":"stream","text":["1194\n"]}],"source":["path = 'train_annotations' \n","file_list = os.listdir(path) \n","print (len(file_list))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"nOBD56ifYzpl"},"outputs":[],"source":["file_list.sort()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"gM6D5OqyW3by"},"outputs":[],"source":["import os\n","import glob\n","import matplotlib.pyplot as plt\n","import matplotlib.patches as patches\n","from bs4 import BeautifulSoup\n","\n","def generate_box(obj):\n","    \n","    xmin = float(obj.find('xmin').text)\n","    ymin = float(obj.find('ymin').text)\n","    xmax = float(obj.find('xmax').text)\n","    ymax = float(obj.find('ymax').text)\n","    \n","    return [xmin, ymin, xmax, ymax]\n","\n","def generate_label(obj):\n","\n","    if obj.find('name').text == \"with_mask\":\n","\n","        return 1\n","\n","    elif obj.find('name').text == \"mask_weared_incorrect\":\n","\n","        return 2\n","\n","    return 0\n","\n","\n","def generate_target(file): \n","    with open(file) as f:\n","        data = f.read()\n","        soup = BeautifulSoup(data, \"html.parser\")\n","        objects = soup.find_all(\"object\")\n","\n","        num_objs = len(objects)\n","\n","        boxes = []\n","        labels = []\n","        for i in objects:\n","            boxes.append(generate_box(i))\n","            labels.append(generate_label(i))\n","\n","        boxes = torch.as_tensor(boxes, dtype=torch.float32) \n","        labels = torch.as_tensor(labels, dtype=torch.int64) \n","        \n","        target = {}\n","        target[\"boxes\"] = boxes\n","        target[\"labels\"] = labels\n","        \n","        return target"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"giZJxvAeUmFH"},"outputs":[],"source":["from PIL import Image\n","import cv2\n","import numpy as np\n","import time\n","import torch\n","import torchvision\n","from torch.utils.data import Dataset\n","from torchvision import transforms\n","import albumentations\n","import albumentations.pytorch\n","from matplotlib import pyplot as plt\n","import os\n","import random\n","\n","class BboxAugmentationDataset(Dataset):\n","    def __init__(self, path, transform=None):\n","        self.path = path   \n","        self.imgs = list(sorted(os.listdir(self.path)))  \n","        self.transform = transform\n","        \n","    def __len__(self):\n","        return len(self.imgs)\n","\n","    def __getitem__(self, idx):\n","        file_image = self.imgs[idx]\n","        file_label = self.imgs[idx][:-3] + 'xml'\n","        img_path = os.path.join(self.path, file_image)\n","        label_path = os.path.join(\"train_annotations\", file_label)  # resize된 annotation 경로\n","        \n","        image = cv2.imread(img_path)\n","        image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)\n","\n","        target = generate_target(label_path)\n","\n","        if self.transform:\n","            transformed = self.transform(image = image, bboxes = target['boxes'], labels = target['labels'])\n","            image = transformed['image']\n","            target = {'boxes':transformed['bboxes'], 'labels':transformed['labels']}\n","        \n","            \n","        return image, target"]},{"cell_type":"markdown","metadata":{"id":"hHIJP-aK3Ex1"},"source":["###HorizontalFlip"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"YrV4iVgFXu5Q"},"outputs":[],"source":["bbox_transform = albumentations.Compose(\n","    [\n","     albumentations.HorizontalFlip(p=1),\n","     #albumentations.VerticalFlip(p=1),\n","     #albumentations.Rotate(p=1),\n","     albumentations.pytorch.transforms.ToTensorV2()],\n","    bbox_params=albumentations.BboxParams(format='pascal_voc', label_fields=['labels']),\n",")\n","\n","# 바운딩 박스 표기법: xmin, ymin, xmax, ymax = pascal_voc 표기법"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":36},"executionInfo":{"elapsed":2,"status":"ok","timestamp":1647959364844,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"3ZTT-41qrK--","outputId":"e89112e2-6223-411a-8c60-54141fe474cb"},"outputs":[{"data":{"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"},"text/plain":["'/content/drive/MyDrive/CNNproject/image'"]},"execution_count":47,"metadata":{},"output_type":"execute_result"}],"source":["os.getcwd()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_US4gppjXNG_"},"outputs":[],"source":["import pandas as pd\n","\n","path_i = 'train_images'\n","path_a = 'train_annotations' \n","file_list_i = os.listdir(path_i)\n","file_list_a = os.listdir(path_a)\n","file_list_i.sort()\n","file_list_a.sort()\n","\n","df_a = pd.DataFrame(columns = {'file_name','xmin','ymin','xmax','ymax'})\n","\n","bbox_transform_dataset = BboxAugmentationDataset(\n","    path = 'train_images/',  # resize된 image 경로\n","    transform = bbox_transform\n",")\n","\n","for i in range(len(file_list_i)):\n","    try:\n","       img, annot = bbox_transform_dataset[i]\n","       img = img.detach().cpu().numpy() # tensor -\u003e numpy\n","       img = np.transpose(img, (1, 2, 0)) # [C,H,W] -\u003e [H,W,C]\n","       #img = denormalize(img) # *255 or IMAGENET denorm 방법\n","       img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB) # RGB 채널\n","       img = img.astype(np.uint8).copy() # np.float32 -\u003e np.uint8\n","\n","       cv2.imwrite('img_/' + file_list_i[i][0:-4]+'_hflip.png',img)\n","\n","       for j in range(len(annot['boxes'])):\n","         df_a = df_a.append({'file': file_list_a[i][0:-4]+'_hflip',\n","                             'name':annot['labels'][j],\n","                             'xmin':annot['boxes'][j][0], \n","                             'ymin':annot['boxes'][j][1], \n","                             'xmax':annot['boxes'][j][2], \n","                             'ymax':annot['boxes'][j][3]},\n","                            ignore_index=True)  \n","    except:\n","        pass"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":487},"executionInfo":{"elapsed":7,"status":"ok","timestamp":1647959981324,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"3odF1sNEqFQ_","outputId":"7d8e63d0-9d5d-4849-9088-8f8988d6a61a"},"outputs":[{"data":{"text/html":["\n","  \u003cdiv id=\"df-9183e985-d2cf-4373-abfe-79c11151a726\"\u003e\n","    \u003cdiv class=\"colab-df-container\"\u003e\n","      \u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003efile\u003c/th\u003e\n","      \u003cth\u003ename\u003c/th\u003e\n","      \u003cth\u003exmin\u003c/th\u003e\n","      \u003cth\u003eymin\u003c/th\u003e\n","      \u003cth\u003exmax\u003c/th\u003e\n","      \u003cth\u003eymax\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003egray_maksssksksss0_hflip\u003c/td\u003e\n","      \u003ctd\u003etensor(0)\u003c/td\u003e\n","      \u003ctd\u003e504.000015\u003c/td\u003e\n","      \u003ctd\u003e136.999998\u003c/td\u003e\n","      \u003ctd\u003e542.000008\u003c/td\u003e\n","      \u003ctd\u003e185.999994\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003egray_maksssksksss0_hflip\u003c/td\u003e\n","      \u003ctd\u003etensor(1)\u003c/td\u003e\n","      \u003ctd\u003e357.999992\u003c/td\u003e\n","      \u003ctd\u003e131.000004\u003c/td\u003e\n","      \u003ctd\u003e409.000015\u003c/td\u003e\n","      \u003ctd\u003e188.000007\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003egray_maksssksksss0_hflip\u003c/td\u003e\n","      \u003ctd\u003etensor(0)\u003c/td\u003e\n","      \u003ctd\u003e190.000000\u003c/td\u003e\n","      \u003ctd\u003e118.000002\u003c/td\u003e\n","      \u003ctd\u003e234.000015\u003c/td\u003e\n","      \u003ctd\u003e183.999996\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e3\u003c/th\u003e\n","      \u003ctd\u003egray_maksssksksss1_hflip\u003c/td\u003e\n","      \u003ctd\u003etensor(1)\u003c/td\u003e\n","      \u003ctd\u003e74.000015\u003c/td\u003e\n","      \u003ctd\u003e104.000001\u003c/td\u003e\n","      \u003ctd\u003e127.000008\u003c/td\u003e\n","      \u003ctd\u003e211.999998\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4\u003c/th\u003e\n","      \u003ctd\u003egray_maksssksksss1_hflip\u003c/td\u003e\n","      \u003ctd\u003etensor(1)\u003c/td\u003e\n","      \u003ctd\u003e222.999992\u003c/td\u003e\n","      \u003ctd\u003e115.999997\u003c/td\u003e\n","      \u003ctd\u003e282.000008\u003c/td\u003e\n","      \u003ctd\u003e224.000001\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e...\u003c/th\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e5275\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss98_hflip\u003c/td\u003e\n","      \u003ctd\u003etensor(1)\u003c/td\u003e\n","      \u003ctd\u003e180.999985\u003c/td\u003e\n","      \u003ctd\u003e111.000001\u003c/td\u003e\n","      \u003ctd\u003e220.000000\u003c/td\u003e\n","      \u003ctd\u003e151.999998\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e5276\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss98_hflip\u003c/td\u003e\n","      \u003ctd\u003etensor(1)\u003c/td\u003e\n","      \u003ctd\u003e37.000008\u003c/td\u003e\n","      \u003ctd\u003e143.000007\u003c/td\u003e\n","      \u003ctd\u003e90.000000\u003c/td\u003e\n","      \u003ctd\u003e190.000005\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e5277\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss99_hflip\u003c/td\u003e\n","      \u003ctd\u003etensor(2)\u003c/td\u003e\n","      \u003ctd\u003e204.000015\u003c/td\u003e\n","      \u003ctd\u003e97.000000\u003c/td\u003e\n","      \u003ctd\u003e350.999985\u003c/td\u003e\n","      \u003ctd\u003e290.999994\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e5278\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss99_hflip\u003c/td\u003e\n","      \u003ctd\u003etensor(1)\u003c/td\u003e\n","      \u003ctd\u003e359.000015\u003c/td\u003e\n","      \u003ctd\u003e155.999994\u003c/td\u003e\n","      \u003ctd\u003e482.000008\u003c/td\u003e\n","      \u003ctd\u003e296.000004\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e5279\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss99_hflip\u003c/td\u003e\n","      \u003ctd\u003etensor(1)\u003c/td\u003e\n","      \u003ctd\u003e72.000008\u003c/td\u003e\n","      \u003ctd\u003e177.000003\u003c/td\u003e\n","      \u003ctd\u003e177.999992\u003c/td\u003e\n","      \u003ctd\u003e418.000002\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003cp\u003e5280 rows × 6 columns\u003c/p\u003e\n","\u003c/div\u003e\n","      \u003cbutton class=\"colab-df-convert\" onclick=\"convertToInteractive('df-9183e985-d2cf-4373-abfe-79c11151a726')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\"\u003e\n","        \n","  \u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\"\u003e\n","    \u003cpath d=\"M0 0h24v24H0V0z\" fill=\"none\"/\u003e\n","    \u003cpath d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/\u003e\u003cpath d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/\u003e\n","  \u003c/svg\u003e\n","      \u003c/button\u003e\n","      \n","  \u003cstyle\u003e\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  \u003c/style\u003e\n","\n","      \u003cscript\u003e\n","        const buttonEl =\n","          document.querySelector('#df-9183e985-d2cf-4373-abfe-79c11151a726 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-9183e985-d2cf-4373-abfe-79c11151a726');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '\u003ca target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb\u003edata table notebook\u003c/a\u003e'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      \u003c/script\u003e\n","    \u003c/div\u003e\n","  \u003c/div\u003e\n","  "],"text/plain":["                          file       name        xmin        ymin        xmax  \\\n","0     gray_maksssksksss0_hflip  tensor(0)  504.000015  136.999998  542.000008   \n","1     gray_maksssksksss0_hflip  tensor(1)  357.999992  131.000004  409.000015   \n","2     gray_maksssksksss0_hflip  tensor(0)  190.000000  118.000002  234.000015   \n","3     gray_maksssksksss1_hflip  tensor(1)   74.000015  104.000001  127.000008   \n","4     gray_maksssksksss1_hflip  tensor(1)  222.999992  115.999997  282.000008   \n","...                        ...        ...         ...         ...         ...   \n","5275      maksssksksss98_hflip  tensor(1)  180.999985  111.000001  220.000000   \n","5276      maksssksksss98_hflip  tensor(1)   37.000008  143.000007   90.000000   \n","5277      maksssksksss99_hflip  tensor(2)  204.000015   97.000000  350.999985   \n","5278      maksssksksss99_hflip  tensor(1)  359.000015  155.999994  482.000008   \n","5279      maksssksksss99_hflip  tensor(1)   72.000008  177.000003  177.999992   \n","\n","            ymax  \n","0     185.999994  \n","1     188.000007  \n","2     183.999996  \n","3     211.999998  \n","4     224.000001  \n","...          ...  \n","5275  151.999998  \n","5276  190.000005  \n","5277  290.999994  \n","5278  296.000004  \n","5279  418.000002  \n","\n","[5280 rows x 6 columns]"]},"execution_count":49,"metadata":{},"output_type":"execute_result"}],"source":["df_a[['file','name','xmin','ymin','xmax','ymax']]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"aGntZwIm1k4_"},"outputs":[],"source":["df_a.loc[df_a['name'] == (1),'name'] = 'with_mask'\n","df_a.loc[df_a['name'] == (2),'name'] = 'mask_weared_incorrect'\n","df_a.loc[df_a['name'] == (0),'name'] = 'without_mask'"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":487},"executionInfo":{"elapsed":6,"status":"ok","timestamp":1647959981758,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"wzkmyh112fHH","outputId":"54037a1f-95a5-43b9-85b0-033f48b55e13"},"outputs":[{"data":{"text/html":["\n","  \u003cdiv id=\"df-6efe182c-09a3-4324-8ad7-b3ffa898204b\"\u003e\n","    \u003cdiv class=\"colab-df-container\"\u003e\n","      \u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003efile\u003c/th\u003e\n","      \u003cth\u003ename\u003c/th\u003e\n","      \u003cth\u003exmin\u003c/th\u003e\n","      \u003cth\u003eymin\u003c/th\u003e\n","      \u003cth\u003exmax\u003c/th\u003e\n","      \u003cth\u003eymax\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003egray_maksssksksss0_hflip\u003c/td\u003e\n","      \u003ctd\u003ewithout_mask\u003c/td\u003e\n","      \u003ctd\u003e504.000015\u003c/td\u003e\n","      \u003ctd\u003e136.999998\u003c/td\u003e\n","      \u003ctd\u003e542.000008\u003c/td\u003e\n","      \u003ctd\u003e185.999994\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003egray_maksssksksss0_hflip\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e357.999992\u003c/td\u003e\n","      \u003ctd\u003e131.000004\u003c/td\u003e\n","      \u003ctd\u003e409.000015\u003c/td\u003e\n","      \u003ctd\u003e188.000007\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003egray_maksssksksss0_hflip\u003c/td\u003e\n","      \u003ctd\u003ewithout_mask\u003c/td\u003e\n","      \u003ctd\u003e190.000000\u003c/td\u003e\n","      \u003ctd\u003e118.000002\u003c/td\u003e\n","      \u003ctd\u003e234.000015\u003c/td\u003e\n","      \u003ctd\u003e183.999996\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e3\u003c/th\u003e\n","      \u003ctd\u003egray_maksssksksss1_hflip\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e74.000015\u003c/td\u003e\n","      \u003ctd\u003e104.000001\u003c/td\u003e\n","      \u003ctd\u003e127.000008\u003c/td\u003e\n","      \u003ctd\u003e211.999998\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4\u003c/th\u003e\n","      \u003ctd\u003egray_maksssksksss1_hflip\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e222.999992\u003c/td\u003e\n","      \u003ctd\u003e115.999997\u003c/td\u003e\n","      \u003ctd\u003e282.000008\u003c/td\u003e\n","      \u003ctd\u003e224.000001\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e...\u003c/th\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e5275\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss98_hflip\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e180.999985\u003c/td\u003e\n","      \u003ctd\u003e111.000001\u003c/td\u003e\n","      \u003ctd\u003e220.000000\u003c/td\u003e\n","      \u003ctd\u003e151.999998\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e5276\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss98_hflip\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e37.000008\u003c/td\u003e\n","      \u003ctd\u003e143.000007\u003c/td\u003e\n","      \u003ctd\u003e90.000000\u003c/td\u003e\n","      \u003ctd\u003e190.000005\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e5277\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss99_hflip\u003c/td\u003e\n","      \u003ctd\u003emask_weared_incorrect\u003c/td\u003e\n","      \u003ctd\u003e204.000015\u003c/td\u003e\n","      \u003ctd\u003e97.000000\u003c/td\u003e\n","      \u003ctd\u003e350.999985\u003c/td\u003e\n","      \u003ctd\u003e290.999994\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e5278\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss99_hflip\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e359.000015\u003c/td\u003e\n","      \u003ctd\u003e155.999994\u003c/td\u003e\n","      \u003ctd\u003e482.000008\u003c/td\u003e\n","      \u003ctd\u003e296.000004\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e5279\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss99_hflip\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e72.000008\u003c/td\u003e\n","      \u003ctd\u003e177.000003\u003c/td\u003e\n","      \u003ctd\u003e177.999992\u003c/td\u003e\n","      \u003ctd\u003e418.000002\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003cp\u003e5280 rows × 6 columns\u003c/p\u003e\n","\u003c/div\u003e\n","      \u003cbutton class=\"colab-df-convert\" onclick=\"convertToInteractive('df-6efe182c-09a3-4324-8ad7-b3ffa898204b')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\"\u003e\n","        \n","  \u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\"\u003e\n","    \u003cpath d=\"M0 0h24v24H0V0z\" fill=\"none\"/\u003e\n","    \u003cpath d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/\u003e\u003cpath d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/\u003e\n","  \u003c/svg\u003e\n","      \u003c/button\u003e\n","      \n","  \u003cstyle\u003e\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  \u003c/style\u003e\n","\n","      \u003cscript\u003e\n","        const buttonEl =\n","          document.querySelector('#df-6efe182c-09a3-4324-8ad7-b3ffa898204b button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-6efe182c-09a3-4324-8ad7-b3ffa898204b');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '\u003ca target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb\u003edata table notebook\u003c/a\u003e'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      \u003c/script\u003e\n","    \u003c/div\u003e\n","  \u003c/div\u003e\n","  "],"text/plain":["                          file                   name        xmin        ymin  \\\n","0     gray_maksssksksss0_hflip           without_mask  504.000015  136.999998   \n","1     gray_maksssksksss0_hflip              with_mask  357.999992  131.000004   \n","2     gray_maksssksksss0_hflip           without_mask  190.000000  118.000002   \n","3     gray_maksssksksss1_hflip              with_mask   74.000015  104.000001   \n","4     gray_maksssksksss1_hflip              with_mask  222.999992  115.999997   \n","...                        ...                    ...         ...         ...   \n","5275      maksssksksss98_hflip              with_mask  180.999985  111.000001   \n","5276      maksssksksss98_hflip              with_mask   37.000008  143.000007   \n","5277      maksssksksss99_hflip  mask_weared_incorrect  204.000015   97.000000   \n","5278      maksssksksss99_hflip              with_mask  359.000015  155.999994   \n","5279      maksssksksss99_hflip              with_mask   72.000008  177.000003   \n","\n","            xmax        ymax  \n","0     542.000008  185.999994  \n","1     409.000015  188.000007  \n","2     234.000015  183.999996  \n","3     127.000008  211.999998  \n","4     282.000008  224.000001  \n","...          ...         ...  \n","5275  220.000000  151.999998  \n","5276   90.000000  190.000005  \n","5277  350.999985  290.999994  \n","5278  482.000008  296.000004  \n","5279  177.999992  418.000002  \n","\n","[5280 rows x 6 columns]"]},"execution_count":51,"metadata":{},"output_type":"execute_result"}],"source":["df_a = df_a[['file','name','xmin','ymin','xmax','ymax']]\n","df_a"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"JqYWFa8guTME"},"outputs":[],"source":["file_name = list(df_a.file.unique())"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"G26JUo_TupZG"},"outputs":[],"source":["from xml.etree.ElementTree import Element, SubElement, ElementTree"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"CxYqIu3tuqVN"},"outputs":[],"source":["def writeXML(df, filename, tag):\n","    root = Element('annotation')\n","    SubElement(root, 'folder').text = 'images'\n","    SubElement(root, 'filename').text = filename + tag\n","    SubElement(root, 'path').text = '/content/drive/MyDrive/CNNproject/image/Train/train_images' + filename + tag\n","    source = SubElement(root, 'source')\n","    SubElement(source, 'database').text = 'Unknown'\n","\n","    size = SubElement(root, 'size')\n","    SubElement(size, 'width').text = '640'\n","    SubElement(size, 'height').text = '480'\n","    SubElement(size, 'depth').text = '3'\n","    \n","    SubElement(root, 'segmented').text = '0'\n","\n","    #print(1)\n","    for index, row in df.iterrows():\n","        obj = SubElement(root, 'object')\n","        SubElement(obj, 'name').text = str(row['name'])\n","        SubElement(obj, 'pose').text = 'Unspecified'\n","        SubElement(obj, 'truncated').text = '0'\n","        SubElement(obj, 'occluded').text = '0'\n","        SubElement(obj, 'difficult').text = '0'\n","        bndbox = SubElement(obj, 'bndbox')\n","        SubElement(bndbox, 'xmin').text = str(row['xmin'])\n","        SubElement(bndbox, 'ymin').text = str(row['ymin'])\n","        SubElement(bndbox, 'xmax').text = str(row['xmax'])\n","        SubElement(bndbox, 'ymax').text = str(row['ymax'])\n","        #print(obj.tag)\n","        \n","    tree = ElementTree(root)\n","    #print(root.text)\n","    tree.write(\"/content/drive/MyDrive/CNNproject/image/annot_/\" + filename + \".xml\", encoding = 'utf-8', xml_declaration=True)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2UHPG9i0vOQX"},"outputs":[],"source":["for i in file_name:\n","    temp = df_a[df_a['file'] == i]\n","    writeXML(temp, i, '.png')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":6,"status":"ok","timestamp":1647960182387,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"6vZUzmoPsDBS","outputId":"90510209-4fb6-45cb-8110-9cc18e8e6a37"},"outputs":[{"data":{"text/plain":["2360"]},"execution_count":56,"metadata":{},"output_type":"execute_result"}],"source":["len(os.listdir(\"./annot_/\"))"]},{"cell_type":"markdown","metadata":{"id":"JgnrIZVO3MJz"},"source":["###VerticalFlip"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Ip2KxZXd3BpD"},"outputs":[],"source":["bbox_transform = albumentations.Compose(\n","    [\n","     #albumentations.HorizontalFlip(p=1),\n","     albumentations.VerticalFlip(p=1),\n","     #albumentations.Rotate(p=1),\n","     albumentations.pytorch.transforms.ToTensorV2()],\n","    bbox_params=albumentations.BboxParams(format='pascal_voc', label_fields=['labels']),\n",")\n","\n","# 바운딩 박스 표기법: xmin, ymin, xmax, ymax = pascal_voc 표기법"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"NYXjLTg_3aAN"},"outputs":[],"source":["import pandas as pd\n","\n","path_i = 'train_images'\n","path_a = 'train_annotations' \n","file_list_i = os.listdir(path_i)\n","file_list_a = os.listdir(path_a)\n","file_list_i.sort()\n","file_list_a.sort()\n","\n","df_a = pd.DataFrame(columns = {'file_name','xmin','ymin','xmax','ymax'})\n","\n","bbox_transform_dataset = BboxAugmentationDataset(\n","    path = 'train_images/',  # resize된 image 경로\n","    transform = bbox_transform\n",")\n","\n","for i in range(len(file_list_i)):\n","    try:\n","       img, annot = bbox_transform_dataset[i]\n","       img = img.detach().cpu().numpy() # tensor -\u003e numpy\n","       img = np.transpose(img, (1, 2, 0)) # [C,H,W] -\u003e [H,W,C]\n","       #img = denormalize(img) # *255 or IMAGENET denorm 방법\n","       img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB) # RGB 채널\n","       img = img.astype(np.uint8).copy() # np.float32 -\u003e np.uint8\n","\n","       cv2.imwrite('img_/' + file_list_i[i][0:-4]+'_vflip.png',img)\n","\n","       for j in range(len(annot['boxes'])):\n","         df_a = df_a.append({'file': file_list_a[i][0:-4]+'_vflip',\n","                             'name':annot['labels'][j],\n","                             'xmin':annot['boxes'][j][0], \n","                             'ymin':annot['boxes'][j][1], \n","                             'xmax':annot['boxes'][j][2], \n","                             'ymax':annot['boxes'][j][3]},\n","                            ignore_index=True)  \n","    except:\n","        pass"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":487},"executionInfo":{"elapsed":9,"status":"ok","timestamp":1647960473399,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"o0qtj4Us3pVL","outputId":"679a8875-5f01-4c8c-b575-3346f38bba02"},"outputs":[{"data":{"text/html":["\n","  \u003cdiv id=\"df-33d7ab9a-2dbc-4973-aa8f-03e91672fd86\"\u003e\n","    \u003cdiv class=\"colab-df-container\"\u003e\n","      \u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003efile\u003c/th\u003e\n","      \u003cth\u003ename\u003c/th\u003e\n","      \u003cth\u003exmin\u003c/th\u003e\n","      \u003cth\u003eymin\u003c/th\u003e\n","      \u003cth\u003exmax\u003c/th\u003e\n","      \u003cth\u003eymax\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003egray_maksssksksss0_vflip\u003c/td\u003e\n","      \u003ctd\u003ewithout_mask\u003c/td\u003e\n","      \u003ctd\u003e98.000002\u003c/td\u003e\n","      \u003ctd\u003e294.000006\u003c/td\u003e\n","      \u003ctd\u003e136.000004\u003c/td\u003e\n","      \u003ctd\u003e343.000002\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003egray_maksssksksss0_vflip\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e231.000004\u003c/td\u003e\n","      \u003ctd\u003e292.000008\u003c/td\u003e\n","      \u003ctd\u003e282.000008\u003c/td\u003e\n","      \u003ctd\u003e348.999996\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003egray_maksssksksss0_vflip\u003c/td\u003e\n","      \u003ctd\u003ewithout_mask\u003c/td\u003e\n","      \u003ctd\u003e405.999985\u003c/td\u003e\n","      \u003ctd\u003e296.000004\u003c/td\u003e\n","      \u003ctd\u003e450.000000\u003c/td\u003e\n","      \u003ctd\u003e361.999998\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e3\u003c/th\u003e\n","      \u003ctd\u003egray_maksssksksss1_vflip\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e512.999992\u003c/td\u003e\n","      \u003ctd\u003e268.000002\u003c/td\u003e\n","      \u003ctd\u003e565.999985\u003c/td\u003e\n","      \u003ctd\u003e375.999985\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4\u003c/th\u003e\n","      \u003ctd\u003egray_maksssksksss1_vflip\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e357.999992\u003c/td\u003e\n","      \u003ctd\u003e255.999985\u003c/td\u003e\n","      \u003ctd\u003e417.000008\u003c/td\u003e\n","      \u003ctd\u003e363.999996\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e...\u003c/th\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e5275\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss98_vflip\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e420.000000\u003c/td\u003e\n","      \u003ctd\u003e328.000002\u003c/td\u003e\n","      \u003ctd\u003e459.000015\u003c/td\u003e\n","      \u003ctd\u003e369.000006\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e5276\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss98_vflip\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e550.000000\u003c/td\u003e\n","      \u003ctd\u003e289.999981\u003c/td\u003e\n","      \u003ctd\u003e602.999992\u003c/td\u003e\n","      \u003ctd\u003e337.000008\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e5277\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss99_vflip\u003c/td\u003e\n","      \u003ctd\u003emask_weared_incorrect\u003c/td\u003e\n","      \u003ctd\u003e288.999996\u003c/td\u003e\n","      \u003ctd\u003e189.000006\u003c/td\u003e\n","      \u003ctd\u003e435.999985\u003c/td\u003e\n","      \u003ctd\u003e382.999992\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e5278\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss99_vflip\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e158.000002\u003c/td\u003e\n","      \u003ctd\u003e183.999996\u003c/td\u003e\n","      \u003ctd\u003e281.000004\u003c/td\u003e\n","      \u003ctd\u003e324.000006\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e5279\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss99_vflip\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e462.000008\u003c/td\u003e\n","      \u003ctd\u003e61.999998\u003c/td\u003e\n","      \u003ctd\u003e567.999992\u003c/td\u003e\n","      \u003ctd\u003e303.000011\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003cp\u003e5280 rows × 6 columns\u003c/p\u003e\n","\u003c/div\u003e\n","      \u003cbutton class=\"colab-df-convert\" onclick=\"convertToInteractive('df-33d7ab9a-2dbc-4973-aa8f-03e91672fd86')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\"\u003e\n","        \n","  \u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\"\u003e\n","    \u003cpath d=\"M0 0h24v24H0V0z\" fill=\"none\"/\u003e\n","    \u003cpath d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/\u003e\u003cpath d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/\u003e\n","  \u003c/svg\u003e\n","      \u003c/button\u003e\n","      \n","  \u003cstyle\u003e\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  \u003c/style\u003e\n","\n","      \u003cscript\u003e\n","        const buttonEl =\n","          document.querySelector('#df-33d7ab9a-2dbc-4973-aa8f-03e91672fd86 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-33d7ab9a-2dbc-4973-aa8f-03e91672fd86');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '\u003ca target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb\u003edata table notebook\u003c/a\u003e'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      \u003c/script\u003e\n","    \u003c/div\u003e\n","  \u003c/div\u003e\n","  "],"text/plain":["                          file                   name        xmin        ymin  \\\n","0     gray_maksssksksss0_vflip           without_mask   98.000002  294.000006   \n","1     gray_maksssksksss0_vflip              with_mask  231.000004  292.000008   \n","2     gray_maksssksksss0_vflip           without_mask  405.999985  296.000004   \n","3     gray_maksssksksss1_vflip              with_mask  512.999992  268.000002   \n","4     gray_maksssksksss1_vflip              with_mask  357.999992  255.999985   \n","...                        ...                    ...         ...         ...   \n","5275      maksssksksss98_vflip              with_mask  420.000000  328.000002   \n","5276      maksssksksss98_vflip              with_mask  550.000000  289.999981   \n","5277      maksssksksss99_vflip  mask_weared_incorrect  288.999996  189.000006   \n","5278      maksssksksss99_vflip              with_mask  158.000002  183.999996   \n","5279      maksssksksss99_vflip              with_mask  462.000008   61.999998   \n","\n","            xmax        ymax  \n","0     136.000004  343.000002  \n","1     282.000008  348.999996  \n","2     450.000000  361.999998  \n","3     565.999985  375.999985  \n","4     417.000008  363.999996  \n","...          ...         ...  \n","5275  459.000015  369.000006  \n","5276  602.999992  337.000008  \n","5277  435.999985  382.999992  \n","5278  281.000004  324.000006  \n","5279  567.999992  303.000011  \n","\n","[5280 rows x 6 columns]"]},"execution_count":59,"metadata":{},"output_type":"execute_result"}],"source":["df_a = df_a[['file','name','xmin','ymin','xmax','ymax']]\n","df_a.loc[df_a['name'] == (1),'name'] = 'with_mask'\n","df_a.loc[df_a['name'] == (2),'name'] = 'mask_weared_incorrect'\n","df_a.loc[df_a['name'] == (0),'name'] = 'without_mask'\n","df_a"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ckxs3Y8v3vSs"},"outputs":[],"source":["file_name = list(df_a.file.unique())"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"F4vChqJv38-l"},"outputs":[],"source":["for i in file_name:\n","    temp = df_a[df_a['file'] == i]\n","    writeXML(temp, i, '.png')"]},{"cell_type":"markdown","metadata":{"id":"oCXgZdf63_S0"},"source":["###Rotate"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"X_ZP2u124BjG"},"outputs":[],"source":["bbox_transform = albumentations.Compose(\n","    [\n","     #albumentations.HorizontalFlip(p=1),\n","     #albumentations.VerticalFlip(p=1),\n","     albumentations.Rotate(p=1),\n","     albumentations.pytorch.transforms.ToTensorV2()],\n","    bbox_params=albumentations.BboxParams(format='pascal_voc', label_fields=['labels']),\n",")\n","\n","# 바운딩 박스 표기법: xmin, ymin, xmax, ymax = pascal_voc 표기법"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"w2wfprnm4fl-"},"outputs":[],"source":["import pandas as pd\n","\n","path_i = 'train_images'\n","path_a = 'train_annotations' \n","file_list_i = os.listdir(path_i)\n","file_list_a = os.listdir(path_a)\n","file_list_i.sort()\n","file_list_a.sort()\n","\n","df_a = pd.DataFrame(columns = {'file_name','xmin','ymin','xmax','ymax'})\n","\n","bbox_transform_dataset = BboxAugmentationDataset(\n","    path = 'train_images/',  # resize된 image 경로\n","    transform = bbox_transform\n",")\n","\n","for i in range(len(file_list_i)):\n","    try:\n","       img, annot = bbox_transform_dataset[i]\n","       img = img.detach().cpu().numpy() # tensor -\u003e numpy\n","       img = np.transpose(img, (1, 2, 0)) # [C,H,W] -\u003e [H,W,C]\n","       #img = denormalize(img) # *255 or IMAGENET denorm 방법\n","       img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB) # RGB 채널\n","       img = img.astype(np.uint8).copy() # np.float32 -\u003e np.uint8\n","\n","       cv2.imwrite('img_/' + file_list_i[i][0:-4]+'_rot.png',img)\n","\n","       for j in range(len(annot['boxes'])):\n","         df_a = df_a.append({'file': file_list_a[i][0:-4]+'_rot',\n","                             'name':annot['labels'][j],\n","                             'xmin':annot['boxes'][j][0], \n","                             'ymin':annot['boxes'][j][1], \n","                             'xmax':annot['boxes'][j][2], \n","                             'ymax':annot['boxes'][j][3]},\n","                            ignore_index=True)  \n","    except:\n","        pass"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":487},"executionInfo":{"elapsed":5,"status":"ok","timestamp":1647960963164,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"rd6has2i4rWb","outputId":"5bf76ca8-d54a-4e53-9ec5-197cfc541f87"},"outputs":[{"data":{"text/html":["\n","  \u003cdiv id=\"df-55dadd5a-8ad5-4575-a15d-d77825ffb174\"\u003e\n","    \u003cdiv class=\"colab-df-container\"\u003e\n","      \u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003efile\u003c/th\u003e\n","      \u003cth\u003ename\u003c/th\u003e\n","      \u003cth\u003exmin\u003c/th\u003e\n","      \u003cth\u003eymin\u003c/th\u003e\n","      \u003cth\u003exmax\u003c/th\u003e\n","      \u003cth\u003eymax\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003egray_maksssksksss0_rot\u003c/td\u003e\n","      \u003ctd\u003ewithout_mask\u003c/td\u003e\n","      \u003ctd\u003e82.710114\u003c/td\u003e\n","      \u003ctd\u003e173.040905\u003c/td\u003e\n","      \u003ctd\u003e129.165020\u003c/td\u003e\n","      \u003ctd\u003e228.256602\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003egray_maksssksksss0_rot\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e212.270241\u003c/td\u003e\n","      \u003ctd\u003e139.975719\u003c/td\u003e\n","      \u003ctd\u003e272.986832\u003c/td\u003e\n","      \u003ctd\u003e205.470915\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003egray_maksssksksss0_rot\u003c/td\u003e\n","      \u003ctd\u003ewithout_mask\u003c/td\u003e\n","      \u003ctd\u003e381.793976\u003c/td\u003e\n","      \u003ctd\u003e95.938683\u003c/td\u003e\n","      \u003ctd\u003e437.307739\u003c/td\u003e\n","      \u003ctd\u003e168.973975\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e3\u003c/th\u003e\n","      \u003ctd\u003egray_maksssksksss1_rot\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e341.832695\u003c/td\u003e\n","      \u003ctd\u003e0.000000\u003c/td\u003e\n","      \u003ctd\u003e458.389359\u003c/td\u003e\n","      \u003ctd\u003e75.014806\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4\u003c/th\u003e\n","      \u003ctd\u003egray_maksssksksss1_rot\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e250.344200\u003c/td\u003e\n","      \u003ctd\u003e85.721798\u003c/td\u003e\n","      \u003ctd\u003e370.795746\u003c/td\u003e\n","      \u003ctd\u003e200.708327\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e...\u003c/th\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e5016\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss98_rot\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e436.564484\u003c/td\u003e\n","      \u003ctd\u003e135.483842\u003c/td\u003e\n","      \u003ctd\u003e483.459091\u003c/td\u003e\n","      \u003ctd\u003e183.902335\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e5017\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss98_rot\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e555.371399\u003c/td\u003e\n","      \u003ctd\u003e194.653945\u003c/td\u003e\n","      \u003ctd\u003e617.227859\u003c/td\u003e\n","      \u003ctd\u003e251.938848\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e5018\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss99_rot\u003c/td\u003e\n","      \u003ctd\u003emask_weared_incorrect\u003c/td\u003e\n","      \u003ctd\u003e194.616051\u003c/td\u003e\n","      \u003ctd\u003e57.523298\u003c/td\u003e\n","      \u003ctd\u003e436.637192\u003c/td\u003e\n","      \u003ctd\u003e297.526731\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e5019\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss99_rot\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e147.806168\u003c/td\u003e\n","      \u003ctd\u003e210.835047\u003c/td\u003e\n","      \u003ctd\u003e334.054451\u003c/td\u003e\n","      \u003ctd\u003e396.353531\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e5020\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss99_rot\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e371.435356\u003c/td\u003e\n","      \u003ctd\u003e16.220126\u003c/td\u003e\n","      \u003ctd\u003e619.586105\u003c/td\u003e\n","      \u003ctd\u003e258.575306\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003cp\u003e5021 rows × 6 columns\u003c/p\u003e\n","\u003c/div\u003e\n","      \u003cbutton class=\"colab-df-convert\" onclick=\"convertToInteractive('df-55dadd5a-8ad5-4575-a15d-d77825ffb174')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\"\u003e\n","        \n","  \u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\"\u003e\n","    \u003cpath d=\"M0 0h24v24H0V0z\" fill=\"none\"/\u003e\n","    \u003cpath d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/\u003e\u003cpath d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/\u003e\n","  \u003c/svg\u003e\n","      \u003c/button\u003e\n","      \n","  \u003cstyle\u003e\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  \u003c/style\u003e\n","\n","      \u003cscript\u003e\n","        const buttonEl =\n","          document.querySelector('#df-55dadd5a-8ad5-4575-a15d-d77825ffb174 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-55dadd5a-8ad5-4575-a15d-d77825ffb174');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '\u003ca target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb\u003edata table notebook\u003c/a\u003e'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      \u003c/script\u003e\n","    \u003c/div\u003e\n","  \u003c/div\u003e\n","  "],"text/plain":["                        file                   name        xmin        ymin  \\\n","0     gray_maksssksksss0_rot           without_mask   82.710114  173.040905   \n","1     gray_maksssksksss0_rot              with_mask  212.270241  139.975719   \n","2     gray_maksssksksss0_rot           without_mask  381.793976   95.938683   \n","3     gray_maksssksksss1_rot              with_mask  341.832695    0.000000   \n","4     gray_maksssksksss1_rot              with_mask  250.344200   85.721798   \n","...                      ...                    ...         ...         ...   \n","5016      maksssksksss98_rot              with_mask  436.564484  135.483842   \n","5017      maksssksksss98_rot              with_mask  555.371399  194.653945   \n","5018      maksssksksss99_rot  mask_weared_incorrect  194.616051   57.523298   \n","5019      maksssksksss99_rot              with_mask  147.806168  210.835047   \n","5020      maksssksksss99_rot              with_mask  371.435356   16.220126   \n","\n","            xmax        ymax  \n","0     129.165020  228.256602  \n","1     272.986832  205.470915  \n","2     437.307739  168.973975  \n","3     458.389359   75.014806  \n","4     370.795746  200.708327  \n","...          ...         ...  \n","5016  483.459091  183.902335  \n","5017  617.227859  251.938848  \n","5018  436.637192  297.526731  \n","5019  334.054451  396.353531  \n","5020  619.586105  258.575306  \n","\n","[5021 rows x 6 columns]"]},"execution_count":64,"metadata":{},"output_type":"execute_result"}],"source":["df_a = df_a[['file','name','xmin','ymin','xmax','ymax']]\n","df_a.loc[df_a['name'] == (1),'name'] = 'with_mask'\n","df_a.loc[df_a['name'] == (2),'name'] = 'mask_weared_incorrect'\n","df_a.loc[df_a['name'] == (0),'name'] = 'without_mask'\n","df_a"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"gJDCrXnz4uBD"},"outputs":[],"source":["file_name = list(df_a.file.unique())"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"6byXy3XX4wBe"},"outputs":[],"source":["for i in file_name:\n","    temp = df_a[df_a['file'] == i]\n","    writeXML(temp, i, '.png')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":15,"status":"ok","timestamp":1647961156460,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"-uByGlJC5Xa0","outputId":"60fee1aa-79ec-4b85-a360-5a763ecec1d3"},"outputs":[{"data":{"text/plain":["3540"]},"execution_count":67,"metadata":{},"output_type":"execute_result"}],"source":["print(\"(원본+흑백)*3 이미지 수: \", len(os.listdir('img_')))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":3,"status":"ok","timestamp":1647961156460,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"DQRvcWhy5ige","outputId":"3b991c04-bb81-44ae-dc55-285ea87695ee"},"outputs":[{"data":{"text/plain":["3540"]},"execution_count":68,"metadata":{},"output_type":"execute_result"}],"source":["print(\"(원본+흑백)*3 annotation 수: \", len(os.listdir('annot_')))"]},{"cell_type":"markdown","metadata":{"id":"ZuedwwBmCexJ"},"source":["## (원본+흑백) * 4\n","* 아무 것도 안 한 거\n","* rotate\n","* vflip\n","* hflip"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7l_5GKM6Co-u"},"outputs":[],"source":["def read_all_file(path):\n","   output = os.listdir(path)\n","   file_list = [] \n","   for i in output:\n","      if os.path.isdir(path+\"/\"+i):\n","         file_list.extend(read_all_file(path+\"/\"+i)) \n","      elif os.path.isfile(path+\"/\"+i):\n","         file_list.append(path+\"/\"+i) \n","   return file_list"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"NPHrLxIGC1YO"},"outputs":[],"source":["def copy_all_file(file_list, new_path):\n"," for src_path in file_list:\n","   file = src_path.split(\"/\")[-1] \n","   shutil.copyfile(src_path, new_path+\"/\"+file)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"s4XW_JZ3C53t"},"outputs":[],"source":["origin_img_path = \"./image/train_images/\"\n","origin_annot_path = \"./image/train_annotations/\"\n","\n","aug_img_path = \"./image/img_/\"\n","aug_annot_path = \"./image/annot_/\""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"WJdypBDWDe72"},"outputs":[],"source":["# 최종 파일 경로\n","os.makedirs(\"./BBfinal/data/train/annots\")\n","final_img_path = \"./BBfinal/data/train/images\"\n","final_annot_path = \"./BBfinal/data/train/annots\""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2,"status":"ok","timestamp":1647961331319,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"Y7dfBKf0Jj5-","outputId":"f725b4c1-347f-4a49-afdf-1c6e1d1a9dd3"},"outputs":[{"name":"stdout","output_type":"stream","text":["/content/drive/MyDrive/CNNproject\n"]}],"source":["%cd ."]},{"cell_type":"code","execution_count":null,"metadata":{"id":"I-aUhsFEEND7"},"outputs":[],"source":["import shutil\n","img_path = [origin_img_path, aug_img_path]\n","\n","for path in img_path:\n","  file_list = read_all_file(path)\n","  copy_all_file(file_list, final_img_path)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"qTT_t1_rFaUG"},"outputs":[],"source":["annot_path = [origin_annot_path, aug_annot_path]\n","\n","for path in annot_path:\n","  file_list = read_all_file(path)\n","  copy_all_file(file_list, final_annot_path)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1029,"status":"ok","timestamp":1647963019059,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"kShC2aEqK9bl","outputId":"15dedf63-130d-413b-cf77-e2685e192c58"},"outputs":[{"name":"stdout","output_type":"stream","text":["최종 train 이미지 수:  6091\n","최종 train annotation 수:  4734\n"]}],"source":["print(\"최종 train 이미지 수: \", len(os.listdir(final_img_path)))\n","print(\"최종 train annotation 수: \", len(os.listdir(final_annot_path)))"]},{"cell_type":"markdown","metadata":{"id":"Vs9O9ynkxBK0"},"source":["## save"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":406,"status":"ok","timestamp":1648001879996,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"vPyuIwjkARdx","outputId":"ea09c9a8-e02f-4a64-95a3-e26fa2e8cad4"},"outputs":[{"name":"stdout","output_type":"stream","text":["/content/drive/MyDrive/CNNproject\n"]}],"source":["%cd /content/drive/MyDrive/CNNproject"]},{"cell_type":"markdown","metadata":{"id":"NelnEoo8GBk5"},"source":["### train"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0ymD_JrtAKCc"},"outputs":[],"source":["train_img_folder = \"./BBfinal/data/train/images\"\n","train_annots_folder = \"./BBfinal/data/train/annots\""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":351,"status":"ok","timestamp":1647964212528,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"etGyJrzEUgn8","outputId":"c06803d2-b7ad-452c-d6df-ec005bff80d7"},"outputs":[{"data":{"text/plain":["4734"]},"execution_count":122,"metadata":{},"output_type":"execute_result"}],"source":["len(os.listdir(train_annots_folder))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"YvwP5Z7oU7Vh"},"outputs":[],"source":["dataset = {\n","            \"file\":[],\n","            \"name\":[],    \n","            \"width\":[],\n","            \"height\":[],\n","            \"xmin\":[],\n","            \"ymin\":[],   \n","            \"xmax\":[],\n","            \"ymax\":[],\n","           }"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"kDdsuzGWU8id"},"outputs":[],"source":["for anno in glob.glob(train_annots_folder+\"/*.xml\"):\n","    tree = ET.parse(anno)\n","    \n","    for elem in tree.iter():\n","        if 'filename' in elem.tag:\n","            #print(filename)\n","            filename = elem.text\n","        if 'size' in elem.tag:\n","            for attr in list(elem):\n","                if 'width' in attr.tag: \n","                    width = int(round(float(attr.text)))\n","                if 'height' in attr.tag:\n","                    height = int(round(float(attr.text)))    \n","\n","        if 'object' in elem.tag:\n","            for attr in list(elem):\n","                \n","                if 'name' in attr.tag:\n","                    name = attr.text                 \n","                    dataset['name']+=[name]\n","                    dataset['width']+=[width]\n","                    dataset['height']+=[height] \n","                    #dataset['file']+=[anno.split('/')[-1][0:-4]] \n","                    #print(filename)\n","                    dataset['file'].append(filename[0:-4])\n","                            \n","                if 'bndbox' in attr.tag:\n","                    for dim in list(attr):\n","                        if 'xmin' in dim.tag:\n","                            xmin = int(round(float(dim.text)))\n","                            dataset['xmin']+=[xmin]\n","                        if 'ymin' in dim.tag:\n","                            ymin = int(round(float(dim.text)))\n","                            dataset['ymin']+=[ymin]                                \n","                        if 'xmax' in dim.tag:\n","                            xmax = int(round(float(dim.text)))\n","                            dataset['xmax']+=[xmax]                                \n","                        if 'ymax' in dim.tag:\n","                            ymax = int(round(float(dim.text)))\n","                            dataset['ymax']+=[ymax]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vkTJRaKdQRIf"},"outputs":[],"source":["train_df = pd.DataFrame(dataset)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"elapsed":7,"status":"ok","timestamp":1647964403432,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"8JbY0GL1QZqr","outputId":"8b57200d-8b1a-4d35-a5db-261d3979098e"},"outputs":[{"data":{"text/html":["\n","  \u003cdiv id=\"df-646dd6a7-59a8-463c-a613-63b82d95f06c\"\u003e\n","    \u003cdiv class=\"colab-df-container\"\u003e\n","      \u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003efile\u003c/th\u003e\n","      \u003cth\u003ename\u003c/th\u003e\n","      \u003cth\u003ewidth\u003c/th\u003e\n","      \u003cth\u003eheight\u003c/th\u003e\n","      \u003cth\u003exmin\u003c/th\u003e\n","      \u003cth\u003eymin\u003c/th\u003e\n","      \u003cth\u003exmax\u003c/th\u003e\n","      \u003cth\u003eymax\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss0\u003c/td\u003e\n","      \u003ctd\u003ewithout_mask\u003c/td\u003e\n","      \u003ctd\u003e512\u003c/td\u003e\n","      \u003ctd\u003e366\u003c/td\u003e\n","      \u003ctd\u003e79\u003c/td\u003e\n","      \u003ctd\u003e105\u003c/td\u003e\n","      \u003ctd\u003e109\u003c/td\u003e\n","      \u003ctd\u003e142\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss0\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e512\u003c/td\u003e\n","      \u003ctd\u003e366\u003c/td\u003e\n","      \u003ctd\u003e185\u003c/td\u003e\n","      \u003ctd\u003e100\u003c/td\u003e\n","      \u003ctd\u003e226\u003c/td\u003e\n","      \u003ctd\u003e144\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss0\u003c/td\u003e\n","      \u003ctd\u003ewithout_mask\u003c/td\u003e\n","      \u003ctd\u003e512\u003c/td\u003e\n","      \u003ctd\u003e366\u003c/td\u003e\n","      \u003ctd\u003e325\u003c/td\u003e\n","      \u003ctd\u003e90\u003c/td\u003e\n","      \u003ctd\u003e360\u003c/td\u003e\n","      \u003ctd\u003e141\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e3\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss106\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e600\u003c/td\u003e\n","      \u003ctd\u003e399\u003c/td\u003e\n","      \u003ctd\u003e154\u003c/td\u003e\n","      \u003ctd\u003e51\u003c/td\u003e\n","      \u003ctd\u003e423\u003c/td\u003e\n","      \u003ctd\u003e391\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss11\u003c/td\u003e\n","      \u003ctd\u003emask_weared_incorrect\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e267\u003c/td\u003e\n","      \u003ctd\u003e23\u003c/td\u003e\n","      \u003ctd\u003e114\u003c/td\u003e\n","      \u003ctd\u003e77\u003c/td\u003e\n","      \u003ctd\u003e172\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e\n","      \u003cbutton class=\"colab-df-convert\" onclick=\"convertToInteractive('df-646dd6a7-59a8-463c-a613-63b82d95f06c')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\"\u003e\n","        \n","  \u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\"\u003e\n","    \u003cpath d=\"M0 0h24v24H0V0z\" fill=\"none\"/\u003e\n","    \u003cpath d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/\u003e\u003cpath d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/\u003e\n","  \u003c/svg\u003e\n","      \u003c/button\u003e\n","      \n","  \u003cstyle\u003e\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  \u003c/style\u003e\n","\n","      \u003cscript\u003e\n","        const buttonEl =\n","          document.querySelector('#df-646dd6a7-59a8-463c-a613-63b82d95f06c button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-646dd6a7-59a8-463c-a613-63b82d95f06c');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '\u003ca target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb\u003edata table notebook\u003c/a\u003e'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      \u003c/script\u003e\n","    \u003c/div\u003e\n","  \u003c/div\u003e\n","  "],"text/plain":["              file                   name  width  height  xmin  ymin  xmax  \\\n","0    maksssksksss0           without_mask    512     366    79   105   109   \n","1    maksssksksss0              with_mask    512     366   185   100   226   \n","2    maksssksksss0           without_mask    512     366   325    90   360   \n","3  maksssksksss106              with_mask    600     399   154    51   423   \n","4   maksssksksss11  mask_weared_incorrect    400     267    23   114    77   \n","\n","   ymax  \n","0   142  \n","1   144  \n","2   141  \n","3   391  \n","4   172  "]},"execution_count":141,"metadata":{},"output_type":"execute_result"}],"source":["train_df.head()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mTKX6Rd-QkFC"},"outputs":[],"source":["# class\n","name_dict = {\n","    'with_mask': 0,\n","    'mask_weared_incorrect': 1,\n","    'without_mask': 2 \n","}\n","\n","# train_df['class'] = train_df['name'].map(name_dict)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"nPOu4srAaO_7"},"outputs":[],"source":["train_df[['xmax', 'ymax', 'xmin', 'ymin']] = train_df[['xmax', 'ymax', 'xmin', 'ymin']].astype('int64')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"DlHBgd7hHElz"},"outputs":[],"source":["train_df['x_center'] = (train_df['xmax']+train_df['xmin'])/(2*640)\n","train_df['y_center'] = (train_df['ymax']+train_df['ymin'])/(2*480)\n","train_df['box_height'] = (train_df['xmax']-train_df['xmin'])/640\n","train_df['box_width'] = (train_df['ymax']-train_df['ymin'])/480"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"v55snwEvHd8l"},"outputs":[],"source":["train_df = train_df.astype('string')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":487},"executionInfo":{"elapsed":8,"status":"ok","timestamp":1647964411164,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"GD3OLdfnHh1q","outputId":"09696f2d-9bd5-451f-d158-c6f6e0ca147b"},"outputs":[{"data":{"text/html":["\n","  \u003cdiv id=\"df-05ddcc3e-41ae-4c49-984e-6dd294193dc5\"\u003e\n","    \u003cdiv class=\"colab-df-container\"\u003e\n","      \u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003efile\u003c/th\u003e\n","      \u003cth\u003ename\u003c/th\u003e\n","      \u003cth\u003ewidth\u003c/th\u003e\n","      \u003cth\u003eheight\u003c/th\u003e\n","      \u003cth\u003exmin\u003c/th\u003e\n","      \u003cth\u003eymin\u003c/th\u003e\n","      \u003cth\u003exmax\u003c/th\u003e\n","      \u003cth\u003eymax\u003c/th\u003e\n","      \u003cth\u003eclass\u003c/th\u003e\n","      \u003cth\u003ex_center\u003c/th\u003e\n","      \u003cth\u003ey_center\u003c/th\u003e\n","      \u003cth\u003ebox_height\u003c/th\u003e\n","      \u003cth\u003ebox_width\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss0\u003c/td\u003e\n","      \u003ctd\u003ewithout_mask\u003c/td\u003e\n","      \u003ctd\u003e512\u003c/td\u003e\n","      \u003ctd\u003e366\u003c/td\u003e\n","      \u003ctd\u003e79\u003c/td\u003e\n","      \u003ctd\u003e105\u003c/td\u003e\n","      \u003ctd\u003e109\u003c/td\u003e\n","      \u003ctd\u003e142\u003c/td\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e0.146875\u003c/td\u003e\n","      \u003ctd\u003e0.25729166666666664\u003c/td\u003e\n","      \u003ctd\u003e0.046875\u003c/td\u003e\n","      \u003ctd\u003e0.07708333333333334\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss0\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e512\u003c/td\u003e\n","      \u003ctd\u003e366\u003c/td\u003e\n","      \u003ctd\u003e185\u003c/td\u003e\n","      \u003ctd\u003e100\u003c/td\u003e\n","      \u003ctd\u003e226\u003c/td\u003e\n","      \u003ctd\u003e144\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0.32109375\u003c/td\u003e\n","      \u003ctd\u003e0.25416666666666665\u003c/td\u003e\n","      \u003ctd\u003e0.0640625\u003c/td\u003e\n","      \u003ctd\u003e0.09166666666666666\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss0\u003c/td\u003e\n","      \u003ctd\u003ewithout_mask\u003c/td\u003e\n","      \u003ctd\u003e512\u003c/td\u003e\n","      \u003ctd\u003e366\u003c/td\u003e\n","      \u003ctd\u003e325\u003c/td\u003e\n","      \u003ctd\u003e90\u003c/td\u003e\n","      \u003ctd\u003e360\u003c/td\u003e\n","      \u003ctd\u003e141\u003c/td\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e0.53515625\u003c/td\u003e\n","      \u003ctd\u003e0.240625\u003c/td\u003e\n","      \u003ctd\u003e0.0546875\u003c/td\u003e\n","      \u003ctd\u003e0.10625\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e3\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss106\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e600\u003c/td\u003e\n","      \u003ctd\u003e399\u003c/td\u003e\n","      \u003ctd\u003e154\u003c/td\u003e\n","      \u003ctd\u003e51\u003c/td\u003e\n","      \u003ctd\u003e423\u003c/td\u003e\n","      \u003ctd\u003e391\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0.45078125\u003c/td\u003e\n","      \u003ctd\u003e0.46041666666666664\u003c/td\u003e\n","      \u003ctd\u003e0.4203125\u003c/td\u003e\n","      \u003ctd\u003e0.7083333333333334\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss11\u003c/td\u003e\n","      \u003ctd\u003emask_weared_incorrect\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e267\u003c/td\u003e\n","      \u003ctd\u003e23\u003c/td\u003e\n","      \u003ctd\u003e114\u003c/td\u003e\n","      \u003ctd\u003e77\u003c/td\u003e\n","      \u003ctd\u003e172\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","      \u003ctd\u003e0.078125\u003c/td\u003e\n","      \u003ctd\u003e0.29791666666666666\u003c/td\u003e\n","      \u003ctd\u003e0.084375\u003c/td\u003e\n","      \u003ctd\u003e0.12083333333333333\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e...\u003c/th\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e25370\u003c/th\u003e\n","      \u003ctd\u003egray_maksssksksss98_rot\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e640\u003c/td\u003e\n","      \u003ctd\u003e480\u003c/td\u003e\n","      \u003ctd\u003e418\u003c/td\u003e\n","      \u003ctd\u003e325\u003c/td\u003e\n","      \u003ctd\u003e463\u003c/td\u003e\n","      \u003ctd\u003e369\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0.68828125\u003c/td\u003e\n","      \u003ctd\u003e0.7229166666666667\u003c/td\u003e\n","      \u003ctd\u003e0.0703125\u003c/td\u003e\n","      \u003ctd\u003e0.09166666666666666\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e25371\u003c/th\u003e\n","      \u003ctd\u003egray_maksssksksss98_rot\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e640\u003c/td\u003e\n","      \u003ctd\u003e480\u003c/td\u003e\n","      \u003ctd\u003e395\u003c/td\u003e\n","      \u003ctd\u003e458\u003c/td\u003e\n","      \u003ctd\u003e447\u003c/td\u003e\n","      \u003ctd\u003e480\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0.6578125\u003c/td\u003e\n","      \u003ctd\u003e0.9770833333333333\u003c/td\u003e\n","      \u003ctd\u003e0.08125\u003c/td\u003e\n","      \u003ctd\u003e0.04583333333333333\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e25372\u003c/th\u003e\n","      \u003ctd\u003egray_maksssksksss99_rot\u003c/td\u003e\n","      \u003ctd\u003emask_weared_incorrect\u003c/td\u003e\n","      \u003ctd\u003e640\u003c/td\u003e\n","      \u003ctd\u003e480\u003c/td\u003e\n","      \u003ctd\u003e263\u003c/td\u003e\n","      \u003ctd\u003e176\u003c/td\u003e\n","      \u003ctd\u003e487\u003c/td\u003e\n","      \u003ctd\u003e365\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","      \u003ctd\u003e0.5859375\u003c/td\u003e\n","      \u003ctd\u003e0.5635416666666667\u003c/td\u003e\n","      \u003ctd\u003e0.35\u003c/td\u003e\n","      \u003ctd\u003e0.39375\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e25373\u003c/th\u003e\n","      \u003ctd\u003egray_maksssksksss99_rot\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e640\u003c/td\u003e\n","      \u003ctd\u003e480\u003c/td\u003e\n","      \u003ctd\u003e227\u003c/td\u003e\n","      \u003ctd\u003e63\u003c/td\u003e\n","      \u003ctd\u003e392\u003c/td\u003e\n","      \u003ctd\u003e215\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0.48359375\u003c/td\u003e\n","      \u003ctd\u003e0.28958333333333336\u003c/td\u003e\n","      \u003ctd\u003e0.2578125\u003c/td\u003e\n","      \u003ctd\u003e0.31666666666666665\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e25374\u003c/th\u003e\n","      \u003ctd\u003egray_maksssksksss99_rot\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e640\u003c/td\u003e\n","      \u003ctd\u003e480\u003c/td\u003e\n","      \u003ctd\u003e181\u003c/td\u003e\n","      \u003ctd\u003e363\u003c/td\u003e\n","      \u003ctd\u003e440\u003c/td\u003e\n","      \u003ctd\u003e480\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0.48515625\u003c/td\u003e\n","      \u003ctd\u003e0.878125\u003c/td\u003e\n","      \u003ctd\u003e0.4046875\u003c/td\u003e\n","      \u003ctd\u003e0.24375\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003cp\u003e25375 rows × 13 columns\u003c/p\u003e\n","\u003c/div\u003e\n","      \u003cbutton class=\"colab-df-convert\" onclick=\"convertToInteractive('df-05ddcc3e-41ae-4c49-984e-6dd294193dc5')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\"\u003e\n","        \n","  \u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\"\u003e\n","    \u003cpath d=\"M0 0h24v24H0V0z\" fill=\"none\"/\u003e\n","    \u003cpath d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/\u003e\u003cpath d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/\u003e\n","  \u003c/svg\u003e\n","      \u003c/button\u003e\n","      \n","  \u003cstyle\u003e\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  \u003c/style\u003e\n","\n","      \u003cscript\u003e\n","        const buttonEl =\n","          document.querySelector('#df-05ddcc3e-41ae-4c49-984e-6dd294193dc5 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-05ddcc3e-41ae-4c49-984e-6dd294193dc5');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '\u003ca target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb\u003edata table notebook\u003c/a\u003e'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      \u003c/script\u003e\n","    \u003c/div\u003e\n","  \u003c/div\u003e\n","  "],"text/plain":["                          file                   name width height xmin ymin  \\\n","0                maksssksksss0           without_mask   512    366   79  105   \n","1                maksssksksss0              with_mask   512    366  185  100   \n","2                maksssksksss0           without_mask   512    366  325   90   \n","3              maksssksksss106              with_mask   600    399  154   51   \n","4               maksssksksss11  mask_weared_incorrect   400    267   23  114   \n","...                        ...                    ...   ...    ...  ...  ...   \n","25370  gray_maksssksksss98_rot              with_mask   640    480  418  325   \n","25371  gray_maksssksksss98_rot              with_mask   640    480  395  458   \n","25372  gray_maksssksksss99_rot  mask_weared_incorrect   640    480  263  176   \n","25373  gray_maksssksksss99_rot              with_mask   640    480  227   63   \n","25374  gray_maksssksksss99_rot              with_mask   640    480  181  363   \n","\n","      xmax ymax class    x_center             y_center box_height  \\\n","0      109  142     2    0.146875  0.25729166666666664   0.046875   \n","1      226  144     0  0.32109375  0.25416666666666665  0.0640625   \n","2      360  141     2  0.53515625             0.240625  0.0546875   \n","3      423  391     0  0.45078125  0.46041666666666664  0.4203125   \n","4       77  172     1    0.078125  0.29791666666666666   0.084375   \n","...    ...  ...   ...         ...                  ...        ...   \n","25370  463  369     0  0.68828125   0.7229166666666667  0.0703125   \n","25371  447  480     0   0.6578125   0.9770833333333333    0.08125   \n","25372  487  365     1   0.5859375   0.5635416666666667       0.35   \n","25373  392  215     0  0.48359375  0.28958333333333336  0.2578125   \n","25374  440  480     0  0.48515625             0.878125  0.4046875   \n","\n","                 box_width  \n","0      0.07708333333333334  \n","1      0.09166666666666666  \n","2                  0.10625  \n","3       0.7083333333333334  \n","4      0.12083333333333333  \n","...                    ...  \n","25370  0.09166666666666666  \n","25371  0.04583333333333333  \n","25372              0.39375  \n","25373  0.31666666666666665  \n","25374              0.24375  \n","\n","[25375 rows x 13 columns]"]},"execution_count":146,"metadata":{},"output_type":"execute_result"}],"source":["train_df"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"HXtIgCgQHlTI"},"outputs":[],"source":["# 라벨 저장\n","def create_labels(df, image_list, data_name):\n","    fileNames = [x.split(\".\")[0] for x in image_list]\n","\n","    for name in fileNames:\n","        data = df[df.file==name]\n","        box_list = []\n","        \n","        for index in range(len(data)):\n","            row = data.iloc[index]\n","            box_list.append(row['class']+\" \"+row[\"x_center\"]+\" \"+row[\"y_center\"]\\\n","                        +\" \"+row[\"box_height\"]+\" \"+row[\"box_width\"])\n","            \n","        text = \"\\n\".join(box_list)\n","        with open(\"./BBfinal/data/\"+data_name+\"/labels/\"+name+\".txt\", \"w\") as file:\n","            file.write(text)  "]},{"cell_type":"code","execution_count":null,"metadata":{"id":"SsV6uvXeH-dH"},"outputs":[],"source":["create_labels(train_df, [*os.listdir(train_img_folder)], \"train\")"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":38480,"status":"ok","timestamp":1648002479771,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"bjor6wibmTwY","outputId":"8b9e6f6d-4bf7-489d-a6b2-e997a25370cb"},"outputs":[{"data":{"text/plain":["6091"]},"execution_count":27,"metadata":{},"output_type":"execute_result"}],"source":["len(os.listdir(\"./yolov5/BBfinal/data/train/images\"))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":38689,"status":"ok","timestamp":1648002518454,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"Ta8nWvghmURk","outputId":"d4abd793-236c-446b-d2c9-adbf04db6a89"},"outputs":[{"data":{"text/plain":["6091"]},"execution_count":28,"metadata":{},"output_type":"execute_result"}],"source":["len(os.listdir(\"./yolov5/BBfinal/data/train/labels\"))"]},{"cell_type":"markdown","metadata":{"id":"sHz2fCVbLJ05"},"source":["### test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ejwhOjdsLd1c"},"outputs":[],"source":["test_img_folder = \"./image/test_img_\"\n","test_annots_folder = \"./image/face_mask_detection/annotations\" "]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8UeWsSc2LK7T"},"outputs":[],"source":["# 경한, 유리님 데이터 합치기\n","## 이미지\n","img_file_list = read_all_file(\"./안민용/data/images\")\n","copy_all_file(img_file_list, test_img_folder)\n","\n","## annotation\n","img_file_list = read_all_file(\"./안민용/data/annotations\")\n","copy_all_file(img_file_list, test_annots_folder)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":411,"status":"ok","timestamp":1648001928416,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"Vt648aV2YhV2","outputId":"a6e13a8b-6651-4226-f33c-cd7dad15803f"},"outputs":[{"data":{"text/plain":["205"]},"execution_count":9,"metadata":{},"output_type":"execute_result"}],"source":["len(os.listdir(test_img_folder))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":17284,"status":"ok","timestamp":1648001923888,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"hApVLpmKYlvw","outputId":"0e57e2ae-44cb-47e6-cfb4-dbf223e0c688"},"outputs":[{"data":{"text/plain":["1033"]},"execution_count":8,"metadata":{},"output_type":"execute_result"}],"source":["len(os.listdir(test_annots_folder)) "]},{"cell_type":"code","execution_count":null,"metadata":{"id":"TNgRXoQYPSkj"},"outputs":[],"source":["# 이미지 resize\n","def copyImages(imageList, image_folder):\n","    for image in imageList:\n","        img = Image.open(image_folder+\"/\"+image)\n","        img1 = img.resize((640, 480))\n","        _ = img1.save(\"./yolov5/BBfinal/data/test/images/\"+image)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"f7ndRD5FPVfK"},"outputs":[],"source":["test_img_lst = [*os.listdir(test_img_folder)]\n","copyImages(test_img_lst, test_img_folder)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"LFxm99XbNuRq"},"outputs":[],"source":["# annots.xml df으로 변경\n","dataset = {\n","              \"file\":[],\n","              \"name\":[],    \n","              \"width\":[],\n","              \"height\":[],\n","              \"xmin\":[],\n","              \"ymin\":[],   \n","              \"xmax\":[],\n","              \"ymax\":[],\n","            }\n","\n","for anno in glob.glob(test_annots_folder+\"/*.xml\"):\n","    tree = ET.parse(anno)\n","    \n","    for elem in tree.iter():\n","        if 'filename' in elem.tag:\n","            #print(filename)\n","            filename = elem.text\n","        if 'size' in elem.tag:\n","            for attr in list(elem):\n","                if 'width' in attr.tag: \n","                    width = int(round(float(attr.text)))\n","                if 'height' in attr.tag:\n","                    height = int(round(float(attr.text)))    \n","\n","        if 'object' in elem.tag:\n","            for attr in list(elem):\n","                \n","                if 'name' in attr.tag:\n","                    name = attr.text                 \n","                    dataset['name']+=[name]\n","                    dataset['width']+=[width]\n","                    dataset['height']+=[height] \n","                    #dataset['file']+=[anno.split('/')[-1][0:-4]] \n","                    #print(filename)\n","                    dataset['file'].append(filename[0:-4])\n","                            \n","                if 'bndbox' in attr.tag:\n","                    for dim in list(attr):\n","                        if 'xmin' in dim.tag:\n","                            xmin = int(round(float(dim.text)))\n","                            dataset['xmin']+=[xmin]\n","                        if 'ymin' in dim.tag:\n","                            ymin = int(round(float(dim.text)))\n","                            dataset['ymin']+=[ymin]                                \n","                        if 'xmax' in dim.tag:\n","                            xmax = int(round(float(dim.text)))\n","                            dataset['xmax']+=[xmax]                                \n","                        if 'ymax' in dim.tag:\n","                            ymax = int(round(float(dim.text)))\n","                            dataset['ymax']+=[ymax]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RqR2J0ALbToI"},"outputs":[],"source":["test_df = pd.DataFrame(dataset)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"elapsed":3,"status":"ok","timestamp":1648003524289,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"GdYT7810ZXtb","outputId":"421e96b4-033a-4d1f-aa78-f09f8952160d"},"outputs":[{"data":{"text/html":["\n","  \u003cdiv id=\"df-019919ac-ec64-453b-8fb2-fc3d36b466a0\"\u003e\n","    \u003cdiv class=\"colab-df-container\"\u003e\n","      \u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003efile\u003c/th\u003e\n","      \u003cth\u003ename\u003c/th\u003e\n","      \u003cth\u003ewidth\u003c/th\u003e\n","      \u003cth\u003eheight\u003c/th\u003e\n","      \u003cth\u003exmin\u003c/th\u003e\n","      \u003cth\u003eymin\u003c/th\u003e\n","      \u003cth\u003exmax\u003c/th\u003e\n","      \u003cth\u003eymax\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss48\u003c/td\u003e\n","      \u003ctd\u003ewithout_mask\u003c/td\u003e\n","      \u003ctd\u003e301\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e85\u003c/td\u003e\n","      \u003ctd\u003e152\u003c/td\u003e\n","      \u003ctd\u003e190\u003c/td\u003e\n","      \u003ctd\u003e279\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss455\u003c/td\u003e\n","      \u003ctd\u003ewithout_mask\u003c/td\u003e\n","      \u003ctd\u003e301\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e115\u003c/td\u003e\n","      \u003ctd\u003e222\u003c/td\u003e\n","      \u003ctd\u003e225\u003c/td\u003e\n","      \u003ctd\u003e373\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss511\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e294\u003c/td\u003e\n","      \u003ctd\u003e152\u003c/td\u003e\n","      \u003ctd\u003e100\u003c/td\u003e\n","      \u003ctd\u003e241\u003c/td\u003e\n","      \u003ctd\u003e182\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e3\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss614\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e301\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e103\u003c/td\u003e\n","      \u003ctd\u003e197\u003c/td\u003e\n","      \u003ctd\u003e207\u003c/td\u003e\n","      \u003ctd\u003e332\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss634\u003c/td\u003e\n","      \u003ctd\u003emask_weared_incorrect\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e300\u003c/td\u003e\n","      \u003ctd\u003e126\u003c/td\u003e\n","      \u003ctd\u003e62\u003c/td\u003e\n","      \u003ctd\u003e147\u003c/td\u003e\n","      \u003ctd\u003e91\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e...\u003c/th\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4247\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss326\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e382\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e164\u003c/td\u003e\n","      \u003ctd\u003e77\u003c/td\u003e\n","      \u003ctd\u003e230\u003c/td\u003e\n","      \u003ctd\u003e152\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4248\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss326\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e382\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e192\u003c/td\u003e\n","      \u003ctd\u003e116\u003c/td\u003e\n","      \u003ctd\u003e276\u003c/td\u003e\n","      \u003ctd\u003e183\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4249\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss87\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e301\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e129\u003c/td\u003e\n","      \u003ctd\u003e284\u003c/td\u003e\n","      \u003ctd\u003e211\u003c/td\u003e\n","      \u003ctd\u003e387\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4250\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss738\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e267\u003c/td\u003e\n","      \u003ctd\u003e82\u003c/td\u003e\n","      \u003ctd\u003e43\u003c/td\u003e\n","      \u003ctd\u003e123\u003c/td\u003e\n","      \u003ctd\u003e83\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4251\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss738\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e267\u003c/td\u003e\n","      \u003ctd\u003e211\u003c/td\u003e\n","      \u003ctd\u003e27\u003c/td\u003e\n","      \u003ctd\u003e244\u003c/td\u003e\n","      \u003ctd\u003e70\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003cp\u003e4252 rows × 8 columns\u003c/p\u003e\n","\u003c/div\u003e\n","      \u003cbutton class=\"colab-df-convert\" onclick=\"convertToInteractive('df-019919ac-ec64-453b-8fb2-fc3d36b466a0')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\"\u003e\n","        \n","  \u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\"\u003e\n","    \u003cpath d=\"M0 0h24v24H0V0z\" fill=\"none\"/\u003e\n","    \u003cpath d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/\u003e\u003cpath d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/\u003e\n","  \u003c/svg\u003e\n","      \u003c/button\u003e\n","      \n","  \u003cstyle\u003e\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  \u003c/style\u003e\n","\n","      \u003cscript\u003e\n","        const buttonEl =\n","          document.querySelector('#df-019919ac-ec64-453b-8fb2-fc3d36b466a0 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-019919ac-ec64-453b-8fb2-fc3d36b466a0');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '\u003ca target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb\u003edata table notebook\u003c/a\u003e'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      \u003c/script\u003e\n","    \u003c/div\u003e\n","  \u003c/div\u003e\n","  "],"text/plain":["                 file                   name  width  height  xmin  ymin  xmax  \\\n","0      maksssksksss48           without_mask    301     400    85   152   190   \n","1     maksssksksss455           without_mask    301     400   115   222   225   \n","2     maksssksksss511              with_mask    400     294   152   100   241   \n","3     maksssksksss614              with_mask    301     400   103   197   207   \n","4     maksssksksss634  mask_weared_incorrect    400     300   126    62   147   \n","...               ...                    ...    ...     ...   ...   ...   ...   \n","4247  maksssksksss326              with_mask    382     400   164    77   230   \n","4248  maksssksksss326              with_mask    382     400   192   116   276   \n","4249   maksssksksss87              with_mask    301     400   129   284   211   \n","4250  maksssksksss738              with_mask    400     267    82    43   123   \n","4251  maksssksksss738              with_mask    400     267   211    27   244   \n","\n","      ymax  \n","0      279  \n","1      373  \n","2      182  \n","3      332  \n","4       91  \n","...    ...  \n","4247   152  \n","4248   183  \n","4249   387  \n","4250    83  \n","4251    70  \n","\n","[4252 rows x 8 columns]"]},"execution_count":63,"metadata":{},"output_type":"execute_result"}],"source":["test_df"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"iMUITpMlO9UU"},"outputs":[],"source":["def name_change(x):\n","    #name이 face인 경우\n","    if (x == 'face'):\n","        return 'without_mask'\n","    else :\n","        return x\n","\n","test_df['name'] = test_df['name'].apply(lambda x : name_change(x))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"elapsed":4,"status":"ok","timestamp":1648003527497,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"v9ILolz6e5NN","outputId":"e1550fd8-a0fe-4baa-b276-702800fa1672"},"outputs":[{"data":{"text/html":["\n","  \u003cdiv id=\"df-945cec85-e47f-472a-b0af-f84bc61fc8af\"\u003e\n","    \u003cdiv class=\"colab-df-container\"\u003e\n","      \u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003efile\u003c/th\u003e\n","      \u003cth\u003ename\u003c/th\u003e\n","      \u003cth\u003ewidth\u003c/th\u003e\n","      \u003cth\u003eheight\u003c/th\u003e\n","      \u003cth\u003exmin\u003c/th\u003e\n","      \u003cth\u003eymin\u003c/th\u003e\n","      \u003cth\u003exmax\u003c/th\u003e\n","      \u003cth\u003eymax\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss48\u003c/td\u003e\n","      \u003ctd\u003ewithout_mask\u003c/td\u003e\n","      \u003ctd\u003e301\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e85\u003c/td\u003e\n","      \u003ctd\u003e152\u003c/td\u003e\n","      \u003ctd\u003e190\u003c/td\u003e\n","      \u003ctd\u003e279\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss455\u003c/td\u003e\n","      \u003ctd\u003ewithout_mask\u003c/td\u003e\n","      \u003ctd\u003e301\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e115\u003c/td\u003e\n","      \u003ctd\u003e222\u003c/td\u003e\n","      \u003ctd\u003e225\u003c/td\u003e\n","      \u003ctd\u003e373\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss511\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e294\u003c/td\u003e\n","      \u003ctd\u003e152\u003c/td\u003e\n","      \u003ctd\u003e100\u003c/td\u003e\n","      \u003ctd\u003e241\u003c/td\u003e\n","      \u003ctd\u003e182\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e3\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss614\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e301\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e103\u003c/td\u003e\n","      \u003ctd\u003e197\u003c/td\u003e\n","      \u003ctd\u003e207\u003c/td\u003e\n","      \u003ctd\u003e332\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss634\u003c/td\u003e\n","      \u003ctd\u003emask_weared_incorrect\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e300\u003c/td\u003e\n","      \u003ctd\u003e126\u003c/td\u003e\n","      \u003ctd\u003e62\u003c/td\u003e\n","      \u003ctd\u003e147\u003c/td\u003e\n","      \u003ctd\u003e91\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e...\u003c/th\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4247\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss326\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e382\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e164\u003c/td\u003e\n","      \u003ctd\u003e77\u003c/td\u003e\n","      \u003ctd\u003e230\u003c/td\u003e\n","      \u003ctd\u003e152\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4248\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss326\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e382\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e192\u003c/td\u003e\n","      \u003ctd\u003e116\u003c/td\u003e\n","      \u003ctd\u003e276\u003c/td\u003e\n","      \u003ctd\u003e183\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4249\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss87\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e301\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e129\u003c/td\u003e\n","      \u003ctd\u003e284\u003c/td\u003e\n","      \u003ctd\u003e211\u003c/td\u003e\n","      \u003ctd\u003e387\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4250\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss738\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e267\u003c/td\u003e\n","      \u003ctd\u003e82\u003c/td\u003e\n","      \u003ctd\u003e43\u003c/td\u003e\n","      \u003ctd\u003e123\u003c/td\u003e\n","      \u003ctd\u003e83\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4251\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss738\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e267\u003c/td\u003e\n","      \u003ctd\u003e211\u003c/td\u003e\n","      \u003ctd\u003e27\u003c/td\u003e\n","      \u003ctd\u003e244\u003c/td\u003e\n","      \u003ctd\u003e70\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003cp\u003e4252 rows × 8 columns\u003c/p\u003e\n","\u003c/div\u003e\n","      \u003cbutton class=\"colab-df-convert\" onclick=\"convertToInteractive('df-945cec85-e47f-472a-b0af-f84bc61fc8af')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\"\u003e\n","        \n","  \u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\"\u003e\n","    \u003cpath d=\"M0 0h24v24H0V0z\" fill=\"none\"/\u003e\n","    \u003cpath d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/\u003e\u003cpath d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/\u003e\n","  \u003c/svg\u003e\n","      \u003c/button\u003e\n","      \n","  \u003cstyle\u003e\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  \u003c/style\u003e\n","\n","      \u003cscript\u003e\n","        const buttonEl =\n","          document.querySelector('#df-945cec85-e47f-472a-b0af-f84bc61fc8af button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-945cec85-e47f-472a-b0af-f84bc61fc8af');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '\u003ca target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb\u003edata table notebook\u003c/a\u003e'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      \u003c/script\u003e\n","    \u003c/div\u003e\n","  \u003c/div\u003e\n","  "],"text/plain":["                 file                   name  width  height  xmin  ymin  xmax  \\\n","0      maksssksksss48           without_mask    301     400    85   152   190   \n","1     maksssksksss455           without_mask    301     400   115   222   225   \n","2     maksssksksss511              with_mask    400     294   152   100   241   \n","3     maksssksksss614              with_mask    301     400   103   197   207   \n","4     maksssksksss634  mask_weared_incorrect    400     300   126    62   147   \n","...               ...                    ...    ...     ...   ...   ...   ...   \n","4247  maksssksksss326              with_mask    382     400   164    77   230   \n","4248  maksssksksss326              with_mask    382     400   192   116   276   \n","4249   maksssksksss87              with_mask    301     400   129   284   211   \n","4250  maksssksksss738              with_mask    400     267    82    43   123   \n","4251  maksssksksss738              with_mask    400     267   211    27   244   \n","\n","      ymax  \n","0      279  \n","1      373  \n","2      182  \n","3      332  \n","4       91  \n","...    ...  \n","4247   152  \n","4248   183  \n","4249   387  \n","4250    83  \n","4251    70  \n","\n","[4252 rows x 8 columns]"]},"execution_count":65,"metadata":{},"output_type":"execute_result"}],"source":["test_df"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VuRlQguTSFZW"},"outputs":[],"source":["# class\n","name_dict = {\n","    'with_mask': 0,\n","    'mask_weared_incorrect': 1,\n","    'without_mask': 2 \n","}\n","\n","test_df['class'] = test_df['name'].map(name_dict)\n","\n","# int\n","test_df[['xmax', 'ymax', 'xmin', 'ymin']] = test_df[['xmax', 'ymax', 'xmin', 'ymin']].astype('int64')\n","\n","test_df['x_center'] = (test_df['xmax']+test_df['xmin'])/(2*640)\n","test_df['y_center'] = (test_df['ymax']+test_df['ymin'])/(2*480)\n","test_df['box_height'] = (test_df['xmax']-test_df['xmin'])/640\n","test_df['box_width'] = (test_df['ymax']-test_df['ymin'])/480\n","\n","# string\n","test_df = test_df.astype('string')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"elapsed":513,"status":"ok","timestamp":1648003534218,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"ZR58LRYpbt3n","outputId":"d235d0c1-72ae-4e5a-9253-4565d8ec1c83"},"outputs":[{"data":{"text/html":["\n","  \u003cdiv id=\"df-490cfcb5-dd57-460e-911d-e4e657f8ce90\"\u003e\n","    \u003cdiv class=\"colab-df-container\"\u003e\n","      \u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003efile\u003c/th\u003e\n","      \u003cth\u003ename\u003c/th\u003e\n","      \u003cth\u003ewidth\u003c/th\u003e\n","      \u003cth\u003eheight\u003c/th\u003e\n","      \u003cth\u003exmin\u003c/th\u003e\n","      \u003cth\u003eymin\u003c/th\u003e\n","      \u003cth\u003exmax\u003c/th\u003e\n","      \u003cth\u003eymax\u003c/th\u003e\n","      \u003cth\u003eclass\u003c/th\u003e\n","      \u003cth\u003ex_center\u003c/th\u003e\n","      \u003cth\u003ey_center\u003c/th\u003e\n","      \u003cth\u003ebox_height\u003c/th\u003e\n","      \u003cth\u003ebox_width\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss48\u003c/td\u003e\n","      \u003ctd\u003ewithout_mask\u003c/td\u003e\n","      \u003ctd\u003e301\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e85\u003c/td\u003e\n","      \u003ctd\u003e152\u003c/td\u003e\n","      \u003ctd\u003e190\u003c/td\u003e\n","      \u003ctd\u003e279\u003c/td\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e0.21484375\u003c/td\u003e\n","      \u003ctd\u003e0.44895833333333335\u003c/td\u003e\n","      \u003ctd\u003e0.1640625\u003c/td\u003e\n","      \u003ctd\u003e0.26458333333333334\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss455\u003c/td\u003e\n","      \u003ctd\u003ewithout_mask\u003c/td\u003e\n","      \u003ctd\u003e301\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e115\u003c/td\u003e\n","      \u003ctd\u003e222\u003c/td\u003e\n","      \u003ctd\u003e225\u003c/td\u003e\n","      \u003ctd\u003e373\u003c/td\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e0.265625\u003c/td\u003e\n","      \u003ctd\u003e0.6197916666666666\u003c/td\u003e\n","      \u003ctd\u003e0.171875\u003c/td\u003e\n","      \u003ctd\u003e0.3145833333333333\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss511\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e294\u003c/td\u003e\n","      \u003ctd\u003e152\u003c/td\u003e\n","      \u003ctd\u003e100\u003c/td\u003e\n","      \u003ctd\u003e241\u003c/td\u003e\n","      \u003ctd\u003e182\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0.30703125\u003c/td\u003e\n","      \u003ctd\u003e0.29375\u003c/td\u003e\n","      \u003ctd\u003e0.1390625\u003c/td\u003e\n","      \u003ctd\u003e0.17083333333333334\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e3\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss614\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e301\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e103\u003c/td\u003e\n","      \u003ctd\u003e197\u003c/td\u003e\n","      \u003ctd\u003e207\u003c/td\u003e\n","      \u003ctd\u003e332\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0.2421875\u003c/td\u003e\n","      \u003ctd\u003e0.5510416666666667\u003c/td\u003e\n","      \u003ctd\u003e0.1625\u003c/td\u003e\n","      \u003ctd\u003e0.28125\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss634\u003c/td\u003e\n","      \u003ctd\u003emask_weared_incorrect\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e300\u003c/td\u003e\n","      \u003ctd\u003e126\u003c/td\u003e\n","      \u003ctd\u003e62\u003c/td\u003e\n","      \u003ctd\u003e147\u003c/td\u003e\n","      \u003ctd\u003e91\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","      \u003ctd\u003e0.21328125\u003c/td\u003e\n","      \u003ctd\u003e0.159375\u003c/td\u003e\n","      \u003ctd\u003e0.0328125\u003c/td\u003e\n","      \u003ctd\u003e0.06041666666666667\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e...\u003c/th\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4247\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss326\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e382\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e164\u003c/td\u003e\n","      \u003ctd\u003e77\u003c/td\u003e\n","      \u003ctd\u003e230\u003c/td\u003e\n","      \u003ctd\u003e152\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0.3078125\u003c/td\u003e\n","      \u003ctd\u003e0.23854166666666668\u003c/td\u003e\n","      \u003ctd\u003e0.103125\u003c/td\u003e\n","      \u003ctd\u003e0.15625\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4248\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss326\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e382\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e192\u003c/td\u003e\n","      \u003ctd\u003e116\u003c/td\u003e\n","      \u003ctd\u003e276\u003c/td\u003e\n","      \u003ctd\u003e183\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0.365625\u003c/td\u003e\n","      \u003ctd\u003e0.31145833333333334\u003c/td\u003e\n","      \u003ctd\u003e0.13125\u003c/td\u003e\n","      \u003ctd\u003e0.13958333333333334\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4249\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss87\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e301\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e129\u003c/td\u003e\n","      \u003ctd\u003e284\u003c/td\u003e\n","      \u003ctd\u003e211\u003c/td\u003e\n","      \u003ctd\u003e387\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0.265625\u003c/td\u003e\n","      \u003ctd\u003e0.6989583333333333\u003c/td\u003e\n","      \u003ctd\u003e0.128125\u003c/td\u003e\n","      \u003ctd\u003e0.21458333333333332\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4250\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss738\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e267\u003c/td\u003e\n","      \u003ctd\u003e82\u003c/td\u003e\n","      \u003ctd\u003e43\u003c/td\u003e\n","      \u003ctd\u003e123\u003c/td\u003e\n","      \u003ctd\u003e83\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0.16015625\u003c/td\u003e\n","      \u003ctd\u003e0.13125\u003c/td\u003e\n","      \u003ctd\u003e0.0640625\u003c/td\u003e\n","      \u003ctd\u003e0.08333333333333333\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4251\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss738\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e267\u003c/td\u003e\n","      \u003ctd\u003e211\u003c/td\u003e\n","      \u003ctd\u003e27\u003c/td\u003e\n","      \u003ctd\u003e244\u003c/td\u003e\n","      \u003ctd\u003e70\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0.35546875\u003c/td\u003e\n","      \u003ctd\u003e0.10104166666666667\u003c/td\u003e\n","      \u003ctd\u003e0.0515625\u003c/td\u003e\n","      \u003ctd\u003e0.08958333333333333\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003cp\u003e4252 rows × 13 columns\u003c/p\u003e\n","\u003c/div\u003e\n","      \u003cbutton class=\"colab-df-convert\" onclick=\"convertToInteractive('df-490cfcb5-dd57-460e-911d-e4e657f8ce90')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\"\u003e\n","        \n","  \u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\"\u003e\n","    \u003cpath d=\"M0 0h24v24H0V0z\" fill=\"none\"/\u003e\n","    \u003cpath d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/\u003e\u003cpath d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/\u003e\n","  \u003c/svg\u003e\n","      \u003c/button\u003e\n","      \n","  \u003cstyle\u003e\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  \u003c/style\u003e\n","\n","      \u003cscript\u003e\n","        const buttonEl =\n","          document.querySelector('#df-490cfcb5-dd57-460e-911d-e4e657f8ce90 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-490cfcb5-dd57-460e-911d-e4e657f8ce90');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '\u003ca target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb\u003edata table notebook\u003c/a\u003e'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      \u003c/script\u003e\n","    \u003c/div\u003e\n","  \u003c/div\u003e\n","  "],"text/plain":["                 file                   name width height xmin ymin xmax ymax  \\\n","0      maksssksksss48           without_mask   301    400   85  152  190  279   \n","1     maksssksksss455           without_mask   301    400  115  222  225  373   \n","2     maksssksksss511              with_mask   400    294  152  100  241  182   \n","3     maksssksksss614              with_mask   301    400  103  197  207  332   \n","4     maksssksksss634  mask_weared_incorrect   400    300  126   62  147   91   \n","...               ...                    ...   ...    ...  ...  ...  ...  ...   \n","4247  maksssksksss326              with_mask   382    400  164   77  230  152   \n","4248  maksssksksss326              with_mask   382    400  192  116  276  183   \n","4249   maksssksksss87              with_mask   301    400  129  284  211  387   \n","4250  maksssksksss738              with_mask   400    267   82   43  123   83   \n","4251  maksssksksss738              with_mask   400    267  211   27  244   70   \n","\n","     class    x_center             y_center box_height            box_width  \n","0        2  0.21484375  0.44895833333333335  0.1640625  0.26458333333333334  \n","1        2    0.265625   0.6197916666666666   0.171875   0.3145833333333333  \n","2        0  0.30703125              0.29375  0.1390625  0.17083333333333334  \n","3        0   0.2421875   0.5510416666666667     0.1625              0.28125  \n","4        1  0.21328125             0.159375  0.0328125  0.06041666666666667  \n","...    ...         ...                  ...        ...                  ...  \n","4247     0   0.3078125  0.23854166666666668   0.103125              0.15625  \n","4248     0    0.365625  0.31145833333333334    0.13125  0.13958333333333334  \n","4249     0    0.265625   0.6989583333333333   0.128125  0.21458333333333332  \n","4250     0  0.16015625              0.13125  0.0640625  0.08333333333333333  \n","4251     0  0.35546875  0.10104166666666667  0.0515625  0.08958333333333333  \n","\n","[4252 rows x 13 columns]"]},"execution_count":67,"metadata":{},"output_type":"execute_result"}],"source":["test_df"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":335,"status":"ok","timestamp":1647967291333,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"eSG0SWnMf1H6","outputId":"06f88d32-3f4c-44d6-a7bd-6fc77a765e27"},"outputs":[{"name":"stdout","output_type":"stream","text":["/content/drive/MyDrive/CNNproject\n"]}],"source":["%cd /content/drive/MyDrive/CNNproject/"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"YT_Cdsk9fI5M"},"outputs":[],"source":["# 라벨 저장\n","def create_labels(df, image_list, data_name):\n","    fileNames = [x.split(\".\")[0] for x in image_list]\n","\n","    for name in fileNames:\n","        data = df[df.file==name]\n","        box_list = []\n","        \n","        for index in range(len(data)):\n","            row = data.iloc[index]\n","            box_list.append(row['class']+\" \"+row[\"x_center\"]+\" \"+row[\"y_center\"]\\\n","                        +\" \"+row[\"box_height\"]+\" \"+row[\"box_width\"])\n","            \n","        text = \"\\n\".join(box_list)\n","        with open(\"./yolov5/BBfinal/data/\"+data_name+\"/labels/\"+name+\".txt\", \"w\") as file:\n","            file.write(text)  "]},{"cell_type":"code","execution_count":null,"metadata":{"id":"NPHvkxy9fMJB"},"outputs":[],"source":["test_img_list = [*os.listdir(test_img_folder)]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"HRSjBgsHSg90"},"outputs":[],"source":["# 라벨 txt 저장\n","create_labels(test_df, test_img_list, \"test\")"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":521,"status":"ok","timestamp":1648003561832,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"AqOUMnxDlljc","outputId":"7fa6e0a1-8698-4fdf-e8b1-636017caa565"},"outputs":[{"data":{"text/plain":["205"]},"execution_count":71,"metadata":{},"output_type":"execute_result"}],"source":["len(os.listdir(\"./yolov5/BBfinal/data/test/images\"))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":6,"status":"ok","timestamp":1648003562235,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"md9sXBgHlSsF","outputId":"48cdb259-e5b3-43aa-a7ea-ea39b5e8c17b"},"outputs":[{"data":{"text/plain":["205"]},"execution_count":72,"metadata":{},"output_type":"execute_result"}],"source":["len(os.listdir(\"./yolov5/BBfinal/data/test/labels\"))"]},{"cell_type":"markdown","metadata":{"id":"IFfyYbhlSl9q"},"source":["### val"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"V6ztmJBYSozN"},"outputs":[],"source":["val_img_folder = \"./image/val_img_\"\n","val_annots_folder = \"./image/face_mask_detection/annotations\" "]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":9,"status":"ok","timestamp":1648003611814,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"rZDGXNc5cMqu","outputId":"51b56da9-1786-4cf5-e1bf-a7036714969e"},"outputs":[{"data":{"text/plain":["231"]},"execution_count":74,"metadata":{},"output_type":"execute_result"}],"source":["len(os.listdir(val_img_folder))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"td8y9FskS1YQ"},"outputs":[],"source":["# 이미지 resize\n","def copyImages(imageList, image_folder):\n","    for image in imageList:\n","        img = Image.open(image_folder+\"/\"+image)\n","        img1 = img.resize((640, 480))\n","        _ = img1.save(\"./yolov5/BBfinal/data/val/images/\"+image)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"H_mrUzP4S19E"},"outputs":[],"source":["val_img_lst = [*os.listdir(val_img_folder)]\n","copyImages(val_img_lst, val_img_folder)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_8stzKTUS4ha"},"outputs":[],"source":["# annots.xml df으로 변경\n","dataset = {\n","              \"file\":[],\n","              \"name\":[],    \n","              \"width\":[],\n","              \"height\":[],\n","              \"xmin\":[],\n","              \"ymin\":[],   \n","              \"xmax\":[],\n","              \"ymax\":[],\n","            }\n","\n","for anno in glob.glob(val_annots_folder+\"/*.xml\"):\n","    tree = ET.parse(anno)\n","    \n","    for elem in tree.iter():\n","        if 'filename' in elem.tag:\n","            #print(filename)\n","            filename = elem.text\n","        if 'size' in elem.tag:\n","            for attr in list(elem):\n","                if 'width' in attr.tag: \n","                    width = int(round(float(attr.text)))\n","                if 'height' in attr.tag:\n","                    height = int(round(float(attr.text)))    \n","\n","        if 'object' in elem.tag:\n","            for attr in list(elem):\n","                \n","                if 'name' in attr.tag:\n","                    name = attr.text                 \n","                    dataset['name']+=[name]\n","                    dataset['width']+=[width]\n","                    dataset['height']+=[height] \n","                    #dataset['file']+=[anno.split('/')[-1][0:-4]] \n","                    #print(filename)\n","                    dataset['file'].append(filename[0:-4])\n","                            \n","                if 'bndbox' in attr.tag:\n","                    for dim in list(attr):\n","                        if 'xmin' in dim.tag:\n","                            xmin = int(round(float(dim.text)))\n","                            dataset['xmin']+=[xmin]\n","                        if 'ymin' in dim.tag:\n","                            ymin = int(round(float(dim.text)))\n","                            dataset['ymin']+=[ymin]                                \n","                        if 'xmax' in dim.tag:\n","                            xmax = int(round(float(dim.text)))\n","                            dataset['xmax']+=[xmax]                                \n","                        if 'ymax' in dim.tag:\n","                            ymax = int(round(float(dim.text)))\n","                            dataset['ymax']+=[ymax]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Br66JjGzcU7y"},"outputs":[],"source":["val_df = pd.DataFrame(dataset)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"elapsed":508,"status":"ok","timestamp":1648003619729,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"6jjms03ncV8K","outputId":"477825d3-a04c-45eb-aacb-34ec1b85ecdc"},"outputs":[{"data":{"text/html":["\n","  \u003cdiv id=\"df-89a6955a-ca3b-4748-8672-4b027f282643\"\u003e\n","    \u003cdiv class=\"colab-df-container\"\u003e\n","      \u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003efile\u003c/th\u003e\n","      \u003cth\u003ename\u003c/th\u003e\n","      \u003cth\u003ewidth\u003c/th\u003e\n","      \u003cth\u003eheight\u003c/th\u003e\n","      \u003cth\u003exmin\u003c/th\u003e\n","      \u003cth\u003eymin\u003c/th\u003e\n","      \u003cth\u003exmax\u003c/th\u003e\n","      \u003cth\u003eymax\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss48\u003c/td\u003e\n","      \u003ctd\u003ewithout_mask\u003c/td\u003e\n","      \u003ctd\u003e301\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e85\u003c/td\u003e\n","      \u003ctd\u003e152\u003c/td\u003e\n","      \u003ctd\u003e190\u003c/td\u003e\n","      \u003ctd\u003e279\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss455\u003c/td\u003e\n","      \u003ctd\u003ewithout_mask\u003c/td\u003e\n","      \u003ctd\u003e301\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e115\u003c/td\u003e\n","      \u003ctd\u003e222\u003c/td\u003e\n","      \u003ctd\u003e225\u003c/td\u003e\n","      \u003ctd\u003e373\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss511\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e294\u003c/td\u003e\n","      \u003ctd\u003e152\u003c/td\u003e\n","      \u003ctd\u003e100\u003c/td\u003e\n","      \u003ctd\u003e241\u003c/td\u003e\n","      \u003ctd\u003e182\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e3\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss614\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e301\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e103\u003c/td\u003e\n","      \u003ctd\u003e197\u003c/td\u003e\n","      \u003ctd\u003e207\u003c/td\u003e\n","      \u003ctd\u003e332\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss634\u003c/td\u003e\n","      \u003ctd\u003emask_weared_incorrect\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e300\u003c/td\u003e\n","      \u003ctd\u003e126\u003c/td\u003e\n","      \u003ctd\u003e62\u003c/td\u003e\n","      \u003ctd\u003e147\u003c/td\u003e\n","      \u003ctd\u003e91\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e...\u003c/th\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4247\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss326\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e382\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e164\u003c/td\u003e\n","      \u003ctd\u003e77\u003c/td\u003e\n","      \u003ctd\u003e230\u003c/td\u003e\n","      \u003ctd\u003e152\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4248\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss326\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e382\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e192\u003c/td\u003e\n","      \u003ctd\u003e116\u003c/td\u003e\n","      \u003ctd\u003e276\u003c/td\u003e\n","      \u003ctd\u003e183\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4249\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss87\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e301\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e129\u003c/td\u003e\n","      \u003ctd\u003e284\u003c/td\u003e\n","      \u003ctd\u003e211\u003c/td\u003e\n","      \u003ctd\u003e387\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4250\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss738\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e267\u003c/td\u003e\n","      \u003ctd\u003e82\u003c/td\u003e\n","      \u003ctd\u003e43\u003c/td\u003e\n","      \u003ctd\u003e123\u003c/td\u003e\n","      \u003ctd\u003e83\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4251\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss738\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e267\u003c/td\u003e\n","      \u003ctd\u003e211\u003c/td\u003e\n","      \u003ctd\u003e27\u003c/td\u003e\n","      \u003ctd\u003e244\u003c/td\u003e\n","      \u003ctd\u003e70\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003cp\u003e4252 rows × 8 columns\u003c/p\u003e\n","\u003c/div\u003e\n","      \u003cbutton class=\"colab-df-convert\" onclick=\"convertToInteractive('df-89a6955a-ca3b-4748-8672-4b027f282643')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\"\u003e\n","        \n","  \u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\"\u003e\n","    \u003cpath d=\"M0 0h24v24H0V0z\" fill=\"none\"/\u003e\n","    \u003cpath d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/\u003e\u003cpath d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/\u003e\n","  \u003c/svg\u003e\n","      \u003c/button\u003e\n","      \n","  \u003cstyle\u003e\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  \u003c/style\u003e\n","\n","      \u003cscript\u003e\n","        const buttonEl =\n","          document.querySelector('#df-89a6955a-ca3b-4748-8672-4b027f282643 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-89a6955a-ca3b-4748-8672-4b027f282643');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '\u003ca target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb\u003edata table notebook\u003c/a\u003e'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      \u003c/script\u003e\n","    \u003c/div\u003e\n","  \u003c/div\u003e\n","  "],"text/plain":["                 file                   name  width  height  xmin  ymin  xmax  \\\n","0      maksssksksss48           without_mask    301     400    85   152   190   \n","1     maksssksksss455           without_mask    301     400   115   222   225   \n","2     maksssksksss511              with_mask    400     294   152   100   241   \n","3     maksssksksss614              with_mask    301     400   103   197   207   \n","4     maksssksksss634  mask_weared_incorrect    400     300   126    62   147   \n","...               ...                    ...    ...     ...   ...   ...   ...   \n","4247  maksssksksss326              with_mask    382     400   164    77   230   \n","4248  maksssksksss326              with_mask    382     400   192   116   276   \n","4249   maksssksksss87              with_mask    301     400   129   284   211   \n","4250  maksssksksss738              with_mask    400     267    82    43   123   \n","4251  maksssksksss738              with_mask    400     267   211    27   244   \n","\n","      ymax  \n","0      279  \n","1      373  \n","2      182  \n","3      332  \n","4       91  \n","...    ...  \n","4247   152  \n","4248   183  \n","4249   387  \n","4250    83  \n","4251    70  \n","\n","[4252 rows x 8 columns]"]},"execution_count":77,"metadata":{},"output_type":"execute_result"}],"source":["val_df"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"XypHxN3WTGBz"},"outputs":[],"source":["val_df['class'] = val_df['name'].map(name_dict)\n","\n","# int\n","val_df[['xmax', 'ymax', 'xmin', 'ymin']] = val_df[['xmax', 'ymax', 'xmin', 'ymin']].astype('int64')\n","\n","val_df['x_center'] = (val_df['xmax']+val_df['xmin'])/(2*640)\n","val_df['y_center'] = (val_df['ymax']+val_df['ymin'])/(2*480)\n","val_df['box_height'] = (val_df['xmax']-val_df['xmin'])/640\n","val_df['box_width'] = (val_df['ymax']-val_df['ymin'])/480\n","\n","# string\n","val_df = val_df.astype('string')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"elapsed":4,"status":"ok","timestamp":1648003622397,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"gSGLx_sYcfeI","outputId":"a28ebf7f-c110-499d-95dc-5b0e813c8eac"},"outputs":[{"data":{"text/html":["\n","  \u003cdiv id=\"df-f55908b8-2263-4494-91bb-1b7f45521230\"\u003e\n","    \u003cdiv class=\"colab-df-container\"\u003e\n","      \u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003efile\u003c/th\u003e\n","      \u003cth\u003ename\u003c/th\u003e\n","      \u003cth\u003ewidth\u003c/th\u003e\n","      \u003cth\u003eheight\u003c/th\u003e\n","      \u003cth\u003exmin\u003c/th\u003e\n","      \u003cth\u003eymin\u003c/th\u003e\n","      \u003cth\u003exmax\u003c/th\u003e\n","      \u003cth\u003eymax\u003c/th\u003e\n","      \u003cth\u003eclass\u003c/th\u003e\n","      \u003cth\u003ex_center\u003c/th\u003e\n","      \u003cth\u003ey_center\u003c/th\u003e\n","      \u003cth\u003ebox_height\u003c/th\u003e\n","      \u003cth\u003ebox_width\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss48\u003c/td\u003e\n","      \u003ctd\u003ewithout_mask\u003c/td\u003e\n","      \u003ctd\u003e301\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e85\u003c/td\u003e\n","      \u003ctd\u003e152\u003c/td\u003e\n","      \u003ctd\u003e190\u003c/td\u003e\n","      \u003ctd\u003e279\u003c/td\u003e\n","      \u003ctd\u003e2.0\u003c/td\u003e\n","      \u003ctd\u003e0.21484375\u003c/td\u003e\n","      \u003ctd\u003e0.44895833333333335\u003c/td\u003e\n","      \u003ctd\u003e0.1640625\u003c/td\u003e\n","      \u003ctd\u003e0.26458333333333334\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss455\u003c/td\u003e\n","      \u003ctd\u003ewithout_mask\u003c/td\u003e\n","      \u003ctd\u003e301\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e115\u003c/td\u003e\n","      \u003ctd\u003e222\u003c/td\u003e\n","      \u003ctd\u003e225\u003c/td\u003e\n","      \u003ctd\u003e373\u003c/td\u003e\n","      \u003ctd\u003e2.0\u003c/td\u003e\n","      \u003ctd\u003e0.265625\u003c/td\u003e\n","      \u003ctd\u003e0.6197916666666666\u003c/td\u003e\n","      \u003ctd\u003e0.171875\u003c/td\u003e\n","      \u003ctd\u003e0.3145833333333333\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss511\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e294\u003c/td\u003e\n","      \u003ctd\u003e152\u003c/td\u003e\n","      \u003ctd\u003e100\u003c/td\u003e\n","      \u003ctd\u003e241\u003c/td\u003e\n","      \u003ctd\u003e182\u003c/td\u003e\n","      \u003ctd\u003e0.0\u003c/td\u003e\n","      \u003ctd\u003e0.30703125\u003c/td\u003e\n","      \u003ctd\u003e0.29375\u003c/td\u003e\n","      \u003ctd\u003e0.1390625\u003c/td\u003e\n","      \u003ctd\u003e0.17083333333333334\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e3\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss614\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e301\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e103\u003c/td\u003e\n","      \u003ctd\u003e197\u003c/td\u003e\n","      \u003ctd\u003e207\u003c/td\u003e\n","      \u003ctd\u003e332\u003c/td\u003e\n","      \u003ctd\u003e0.0\u003c/td\u003e\n","      \u003ctd\u003e0.2421875\u003c/td\u003e\n","      \u003ctd\u003e0.5510416666666667\u003c/td\u003e\n","      \u003ctd\u003e0.1625\u003c/td\u003e\n","      \u003ctd\u003e0.28125\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss634\u003c/td\u003e\n","      \u003ctd\u003emask_weared_incorrect\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e300\u003c/td\u003e\n","      \u003ctd\u003e126\u003c/td\u003e\n","      \u003ctd\u003e62\u003c/td\u003e\n","      \u003ctd\u003e147\u003c/td\u003e\n","      \u003ctd\u003e91\u003c/td\u003e\n","      \u003ctd\u003e1.0\u003c/td\u003e\n","      \u003ctd\u003e0.21328125\u003c/td\u003e\n","      \u003ctd\u003e0.159375\u003c/td\u003e\n","      \u003ctd\u003e0.0328125\u003c/td\u003e\n","      \u003ctd\u003e0.06041666666666667\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e...\u003c/th\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4247\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss326\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e382\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e164\u003c/td\u003e\n","      \u003ctd\u003e77\u003c/td\u003e\n","      \u003ctd\u003e230\u003c/td\u003e\n","      \u003ctd\u003e152\u003c/td\u003e\n","      \u003ctd\u003e0.0\u003c/td\u003e\n","      \u003ctd\u003e0.3078125\u003c/td\u003e\n","      \u003ctd\u003e0.23854166666666668\u003c/td\u003e\n","      \u003ctd\u003e0.103125\u003c/td\u003e\n","      \u003ctd\u003e0.15625\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4248\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss326\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e382\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e192\u003c/td\u003e\n","      \u003ctd\u003e116\u003c/td\u003e\n","      \u003ctd\u003e276\u003c/td\u003e\n","      \u003ctd\u003e183\u003c/td\u003e\n","      \u003ctd\u003e0.0\u003c/td\u003e\n","      \u003ctd\u003e0.365625\u003c/td\u003e\n","      \u003ctd\u003e0.31145833333333334\u003c/td\u003e\n","      \u003ctd\u003e0.13125\u003c/td\u003e\n","      \u003ctd\u003e0.13958333333333334\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4249\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss87\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e301\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e129\u003c/td\u003e\n","      \u003ctd\u003e284\u003c/td\u003e\n","      \u003ctd\u003e211\u003c/td\u003e\n","      \u003ctd\u003e387\u003c/td\u003e\n","      \u003ctd\u003e0.0\u003c/td\u003e\n","      \u003ctd\u003e0.265625\u003c/td\u003e\n","      \u003ctd\u003e0.6989583333333333\u003c/td\u003e\n","      \u003ctd\u003e0.128125\u003c/td\u003e\n","      \u003ctd\u003e0.21458333333333332\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4250\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss738\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e267\u003c/td\u003e\n","      \u003ctd\u003e82\u003c/td\u003e\n","      \u003ctd\u003e43\u003c/td\u003e\n","      \u003ctd\u003e123\u003c/td\u003e\n","      \u003ctd\u003e83\u003c/td\u003e\n","      \u003ctd\u003e0.0\u003c/td\u003e\n","      \u003ctd\u003e0.16015625\u003c/td\u003e\n","      \u003ctd\u003e0.13125\u003c/td\u003e\n","      \u003ctd\u003e0.0640625\u003c/td\u003e\n","      \u003ctd\u003e0.08333333333333333\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4251\u003c/th\u003e\n","      \u003ctd\u003emaksssksksss738\u003c/td\u003e\n","      \u003ctd\u003ewith_mask\u003c/td\u003e\n","      \u003ctd\u003e400\u003c/td\u003e\n","      \u003ctd\u003e267\u003c/td\u003e\n","      \u003ctd\u003e211\u003c/td\u003e\n","      \u003ctd\u003e27\u003c/td\u003e\n","      \u003ctd\u003e244\u003c/td\u003e\n","      \u003ctd\u003e70\u003c/td\u003e\n","      \u003ctd\u003e0.0\u003c/td\u003e\n","      \u003ctd\u003e0.35546875\u003c/td\u003e\n","      \u003ctd\u003e0.10104166666666667\u003c/td\u003e\n","      \u003ctd\u003e0.0515625\u003c/td\u003e\n","      \u003ctd\u003e0.08958333333333333\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003cp\u003e4252 rows × 13 columns\u003c/p\u003e\n","\u003c/div\u003e\n","      \u003cbutton class=\"colab-df-convert\" onclick=\"convertToInteractive('df-f55908b8-2263-4494-91bb-1b7f45521230')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\"\u003e\n","        \n","  \u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\"\u003e\n","    \u003cpath d=\"M0 0h24v24H0V0z\" fill=\"none\"/\u003e\n","    \u003cpath d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/\u003e\u003cpath d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/\u003e\n","  \u003c/svg\u003e\n","      \u003c/button\u003e\n","      \n","  \u003cstyle\u003e\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  \u003c/style\u003e\n","\n","      \u003cscript\u003e\n","        const buttonEl =\n","          document.querySelector('#df-f55908b8-2263-4494-91bb-1b7f45521230 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-f55908b8-2263-4494-91bb-1b7f45521230');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '\u003ca target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb\u003edata table notebook\u003c/a\u003e'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      \u003c/script\u003e\n","    \u003c/div\u003e\n","  \u003c/div\u003e\n","  "],"text/plain":["                 file                   name width height xmin ymin xmax ymax  \\\n","0      maksssksksss48           without_mask   301    400   85  152  190  279   \n","1     maksssksksss455           without_mask   301    400  115  222  225  373   \n","2     maksssksksss511              with_mask   400    294  152  100  241  182   \n","3     maksssksksss614              with_mask   301    400  103  197  207  332   \n","4     maksssksksss634  mask_weared_incorrect   400    300  126   62  147   91   \n","...               ...                    ...   ...    ...  ...  ...  ...  ...   \n","4247  maksssksksss326              with_mask   382    400  164   77  230  152   \n","4248  maksssksksss326              with_mask   382    400  192  116  276  183   \n","4249   maksssksksss87              with_mask   301    400  129  284  211  387   \n","4250  maksssksksss738              with_mask   400    267   82   43  123   83   \n","4251  maksssksksss738              with_mask   400    267  211   27  244   70   \n","\n","     class    x_center             y_center box_height            box_width  \n","0      2.0  0.21484375  0.44895833333333335  0.1640625  0.26458333333333334  \n","1      2.0    0.265625   0.6197916666666666   0.171875   0.3145833333333333  \n","2      0.0  0.30703125              0.29375  0.1390625  0.17083333333333334  \n","3      0.0   0.2421875   0.5510416666666667     0.1625              0.28125  \n","4      1.0  0.21328125             0.159375  0.0328125  0.06041666666666667  \n","...    ...         ...                  ...        ...                  ...  \n","4247   0.0   0.3078125  0.23854166666666668   0.103125              0.15625  \n","4248   0.0    0.365625  0.31145833333333334    0.13125  0.13958333333333334  \n","4249   0.0    0.265625   0.6989583333333333   0.128125  0.21458333333333332  \n","4250   0.0  0.16015625              0.13125  0.0640625  0.08333333333333333  \n","4251   0.0  0.35546875  0.10104166666666667  0.0515625  0.08958333333333333  \n","\n","[4252 rows x 13 columns]"]},"execution_count":79,"metadata":{},"output_type":"execute_result"}],"source":["val_df"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"DcqP8cVqTICR"},"outputs":[],"source":["# 라벨 txt 저장\n","create_labels(val_df, val_img_lst, \"val\")"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":8,"status":"ok","timestamp":1648003632475,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"YoAbhg7ZlrBY","outputId":"0859dbc2-3fdb-40b3-922a-37d4df5d4c37"},"outputs":[{"data":{"text/plain":["231"]},"execution_count":81,"metadata":{},"output_type":"execute_result"}],"source":["len(os.listdir(\"./yolov5/BBfinal/data/val/images\"))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":4,"status":"ok","timestamp":1648003632475,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"y43pPcZEltPw","outputId":"950a3ff6-8da0-4fea-c633-098e24c947c7"},"outputs":[{"data":{"text/plain":["231"]},"execution_count":82,"metadata":{},"output_type":"execute_result"}],"source":["len(os.listdir(\"./yolov5/BBfinal/data/val/labels\"))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"gVJ-VpVLc1H8"},"outputs":[],"source":["# path = '/content/drive/MyDrive/CNNproject/BBfinal'\n","# newPath = '/content/drive/MyDrive/CNNproject/yolov5/BBfinal'"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":36},"executionInfo":{"elapsed":3,"status":"ok","timestamp":1647966439379,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"meTJUSI_cuOh","outputId":"5d1ca687-9778-421d-e894-cbe53892d921"},"outputs":[{"data":{"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"},"text/plain":["'/content/drive/MyDrive/CNNproject/yolov5/BBfinal'"]},"execution_count":209,"metadata":{},"output_type":"execute_result"}],"source":["# shutil.move(path, newPath)"]},{"cell_type":"markdown","metadata":{"id":"BgPXWPdOwlUr"},"source":["## yaml"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":403,"status":"ok","timestamp":1647880898177,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"ZAmone_IWhCH","outputId":"9a4c582a-2e56-432c-b08c-3692ee847b1e"},"outputs":[{"name":"stdout","output_type":"stream","text":["/content/drive/MyDrive/CNNproject/yolov5\n"]}],"source":["# %cd yolov5/BBfinal "]},{"cell_type":"code","execution_count":null,"metadata":{"id":"DT2lreUzWsjB"},"outputs":[],"source":["# yaml_text = \"\"\"train: data/train/images\n","# val: data/train/images\n","\n","# nc: 3\n","# names: ['with_mask', 'mask_weared_incorrect', 'without_mask']\"\"\""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tCn6qKNWWzEU"},"outputs":[],"source":["# with open(\"data/data.yaml\", 'w') as file:\n","#     file.write(yaml_text)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":467,"status":"ok","timestamp":1647880924653,"user":{"displayName":"최연수","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiHNQ4D4codbEtGmD1WaZlhEtN4obyrS6hLi68QGg=s64","userId":"16480553800951077652"},"user_tz":-540},"id":"Uy7N43UBW1Lh","outputId":"81e77e50-4e18-4fca-ddb8-91c6ab01d376"},"outputs":[{"name":"stdout","output_type":"stream","text":["train: data/train/images\n","val: data/train/images\n","\n","nc: 3\n","names: ['with_mask', 'mask_weared_incorrect', 'without_mask']"]}],"source":["%cat data/data.yaml"]},{"cell_type":"markdown","metadata":{"id":"v_8-4rKRwmoc"},"source":["# Yolo"]},{"cell_type":"markdown","metadata":{"id":"DQJCsx2yxHkw"},"source":["## coordinate"]},{"cell_type":"markdown","metadata":{"id":"-wKts1WpxKtX"},"source":["# Crop"]},{"cell_type":"markdown","metadata":{"id":"HKncQVaRxL4z"},"source":["# Save"]}],"metadata":{"colab":{"collapsed_sections":[],"name":"BBfinal.ipynb","version":""},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}